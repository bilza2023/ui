import{S as q,i as B,s as F,n as x,d as i,f as z,h as p,x as d,B as G,m as E,j as _,k,A as S,q as C,o as m,M as U,e as L,l as P,p as D,E as J,C as K,H as O}from"../chunks/MRdXX-TE.js";import{e as V}from"../chunks/ReGSdYAt.js";import"../chunks/IHki7fMi.js";function j(o,t,l){const e=o.slice();return e[5]=t[l],e}function Q(o){let t,l=V(o[3]),e=[];for(let s=0;s<l.length;s+=1)e[s]=T(j(o,l,s));return{c(){t=m("ul");for(let s=0;s<e.length;s+=1)e[s].c();this.h()},l(s){t=_(s,"UL",{class:!0});var c=k(t);for(let a=0;a<e.length;a+=1)e[a].l(c);c.forEach(i),this.h()},h(){d(t,"class","list svelte-zu442p")},m(s,c){z(s,t,c);for(let a=0;a<e.length;a+=1)e[a]&&e[a].m(t,null)},p(s,c){if(c&8){l=V(s[3]);let a;for(a=0;a<l.length;a+=1){const u=j(s,l,a);e[a]?e[a].p(u,c):(e[a]=T(u),e[a].c(),e[a].m(t,null))}for(;a<e.length;a+=1)e[a].d(1);e.length=l.length}},d(s){s&&i(t),J(e,s)}}}function R(o){let t,l="No new messages.";return{c(){t=m("p"),t.textContent=l,this.h()},l(e){t=_(e,"P",{class:!0,"data-svelte-h":!0}),S(t)!=="svelte-1lbst4x"&&(t.textContent=l),this.h()},h(){d(t,"class","muted svelte-zu442p")},m(e,s){z(e,t,s)},p:x,d(e){e&&i(t)}}}function W(o){let t,l='<p>Please log in to see your messages.</p> <a class="btn svelte-zu442p" href="/login">Log in</a>';return{c(){t=m("div"),t.innerHTML=l,this.h()},l(e){t=_(e,"DIV",{class:!0,"data-svelte-h":!0}),S(t)!=="svelte-19skkxw"&&(t.innerHTML=l),this.h()},h(){d(t,"class","empty svelte-zu442p")},m(e,s){z(e,t,s)},p:x,d(e){e&&i(t)}}}function X(o){let t,l;return{c(){t=m("p"),l=D(o[1]),this.h()},l(e){t=_(e,"P",{class:!0});var s=k(t);l=P(s,o[1]),s.forEach(i),this.h()},h(){d(t,"class","err svelte-zu442p")},m(e,s){z(e,t,s),p(t,l)},p(e,s){s&2&&L(l,e[1])},d(e){e&&i(t)}}}function Y(o){let t,l="Loadingâ€¦";return{c(){t=m("p"),t.textContent=l,this.h()},l(e){t=_(e,"P",{class:!0,"data-svelte-h":!0}),S(t)!=="svelte-jbr5m6"&&(t.textContent=l),this.h()},h(){d(t,"class","muted svelte-zu442p")},m(e,s){z(e,t,s)},p:x,d(e){e&&i(t)}}}function T(o){let t,l,e,s=o[5].category+"",c,a,u,h=N(o[5].created_at)+"",n,r,f,b,g=o[5].message+"",I;return{c(){t=m("li"),l=m("div"),e=m("span"),c=D(s),a=C(),u=m("span"),n=D(h),r=C(),f=m("div"),b=new O(!1),I=C(),this.h()},l(y){t=_(y,"LI",{class:!0});var v=k(t);l=_(v,"DIV",{class:!0});var w=k(l);e=_(w,"SPAN",{class:!0});var H=k(e);c=P(H,s),H.forEach(i),a=E(w),u=_(w,"SPAN",{class:!0});var A=k(u);n=P(A,h),A.forEach(i),w.forEach(i),r=E(v),f=_(v,"DIV",{class:!0});var M=k(f);b=K(M,!1),M.forEach(i),I=E(v),v.forEach(i),this.h()},h(){d(e,"class","cat svelte-zu442p"),d(u,"class","date"),d(l,"class","meta svelte-zu442p"),b.a=null,d(f,"class","body svelte-zu442p"),d(t,"class","msg svelte-zu442p")},m(y,v){z(y,t,v),p(t,l),p(l,e),p(e,c),p(l,a),p(l,u),p(u,n),p(t,r),p(t,f),b.m(g,f),p(t,I)},p(y,v){v&8&&s!==(s=y[5].category+"")&&L(c,s),v&8&&h!==(h=N(y[5].created_at)+"")&&L(n,h),v&8&&g!==(g=y[5].message+"")&&b.p(g)},d(y){y&&i(t)}}}function Z(o){let t,l,e,s,c="Studio",a;function u(r,f){return r[0]?Y:r[1]?X:r[2]?r[3].length===0?R:Q:W}let h=u(o),n=h(o);return{c(){t=C(),l=m("div"),e=m("div"),s=m("h1"),s.textContent=c,a=C(),n.c(),this.h()},l(r){G("svelte-1ubm9zp",document.head).forEach(i),t=E(r),l=_(r,"DIV",{class:!0});var b=k(l);e=_(b,"DIV",{class:!0});var g=k(e);s=_(g,"H1",{class:!0,"data-svelte-h":!0}),S(s)!=="svelte-1xi36hy"&&(s.textContent=c),a=E(g),n.l(g),g.forEach(i),b.forEach(i),this.h()},h(){document.title="Studio",d(s,"class","svelte-zu442p"),d(e,"class","card svelte-zu442p"),d(l,"class","wrap svelte-zu442p")},m(r,f){z(r,t,f),z(r,l,f),p(l,e),p(e,s),p(e,a),n.m(e,null)},p(r,[f]){h===(h=u(r))&&n?n.p(r,f):(n.d(1),n=h(r),n&&(n.c(),n.m(e,null)))},i:x,o:x,d(r){r&&(i(t),i(l)),n.d()}}}function N(o){try{return new Date(o).toLocaleString()}catch{return o}}function $(o,t,l){let e=!0,s="",c=null,a=[];async function u(){l(0,e=!0),l(1,s=""),l(2,c=null),l(3,a=[]);let h=null;try{h=localStorage.getItem("token")}catch{}try{const n=await fetch("/studio",{method:"GET",headers:{accept:"application/json",...h?{authorization:`Bearer ${h}`}:{}}}),r=await n.json().catch(()=>({}));if(!n.ok)throw new Error((r==null?void 0:r.error)||"Failed to load messages");l(2,c=(r==null?void 0:r.user)??null),l(3,a=Array.isArray(r==null?void 0:r.messages)?r.messages:[])}catch(n){l(1,s=(n==null?void 0:n.message)??"Failed to load")}finally{l(0,e=!1)}}return U(u),[e,s,c,a]}class le extends q{constructor(t){super(),B(this,t,$,Z,F,{})}}export{le as component};
