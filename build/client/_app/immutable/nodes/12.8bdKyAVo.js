import{S as nt,i as ot,s as rt,n as He,d as p,E as it,D as ut,F as T,I as $e,e as Ke,f as ie,h as e,J as A,V as ct,x as t,K as dt,j as r,A as O,m as h,k as g,l as Te,o as i,q as _,p as Ne,L as ft}from"../chunks/MRdXX-TE.js";import{e as et}from"../chunks/ReGSdYAt.js";import"../chunks/IHki7fMi.js";function tt(l,n,o){const u=l.slice();return u[22]=n[o],u}function lt(l){let n,o=l[22]+"",u;return{c(){n=i("option"),u=Ne(o),this.h()},l(s){n=r(s,"OPTION",{});var v=g(n);u=Te(v,o),v.forEach(p),this.h()},h(){n.__value=l[22],T(n,n.__value)},m(s,v){ie(s,n,v),e(n,u)},p:He,d(s){s&&p(n)}}}function st(l){let n,o;return{c(){n=i("span"),o=Ne(l[8]),this.h()},l(u){n=r(u,"SPAN",{class:!0});var s=g(n);o=Te(s,l[8]),s.forEach(p),this.h()},h(){t(n,"class","text-green-400")},m(u,s){ie(u,n,s),e(n,o)},p(u,s){s&256&&Ke(o,u[8])},d(u){u&&p(n)}}}function at(l){let n,o;return{c(){n=i("span"),o=Ne(l[9]),this.h()},l(u){n=r(u,"SPAN",{class:!0});var s=g(n);o=Te(s,l[9]),s.forEach(p),this.h()},h(){t(n,"class","text-red-400")},m(u,s){ie(u,n,s),e(n,o)},p(u,s){s&512&&Ke(o,u[9])},d(u){u&&p(n)}}}function pt(l){let n,o="Upload JSON (lean)",u,s,v,D,b,Y="tcode",J,w,Z,j,L,ue="chapter",ce,N,de,F,B,he="exercise",fe,k,pe,V,d,m,U=".json file",z,G,Ue,$,M,Ye="filename (auto)",Pe,y,ke,ee,Q,Ge="status",Ve,P,H,Me="(auto)",Se,R,te,W,Qe="description",je,q,Ae,le,X,Re="tags (csv)",Oe,x,Be,S,K,ve=l[7]?"Uploading…":"Upload JSON",_e,ye,me,qe,se,We="Tip: You can also drag & drop a .json file anywhere on this form.",xe,Xe,ne=et(l[10]),C=[];for(let a=0;a<ne.length;a+=1)C[a]=lt(tt(l,ne,a));let E=l[8]&&st(l),I=l[9]&&at(l);return{c(){n=i("h1"),n.textContent=o,u=_(),s=i("div"),v=i("div"),D=i("div"),b=i("label"),b.textContent=Y,J=_(),w=i("input"),Z=_(),j=i("div"),L=i("label"),L.textContent=ue,ce=_(),N=i("input"),de=_(),F=i("div"),B=i("label"),B.textContent=he,fe=_(),k=i("input"),pe=_(),V=i("div"),d=i("div"),m=i("label"),m.textContent=U,z=_(),G=i("input"),Ue=_(),$=i("div"),M=i("label"),M.textContent=Ye,Pe=_(),y=i("input"),ke=_(),ee=i("div"),Q=i("label"),Q.textContent=Ge,Ve=_(),P=i("select"),H=i("option"),H.textContent=Me;for(let a=0;a<C.length;a+=1)C[a].c();Se=_(),R=i("div"),te=i("div"),W=i("label"),W.textContent=Qe,je=_(),q=i("input"),Ae=_(),le=i("div"),X=i("label"),X.textContent=Re,Oe=_(),x=i("input"),Be=_(),S=i("div"),K=i("button"),_e=Ne(ve),ye=_(),E&&E.c(),me=_(),I&&I.c(),qe=_(),se=i("p"),se.textContent=We,this.h()},l(a){n=r(a,"H1",{class:!0,"data-svelte-h":!0}),O(n)!=="svelte-19ptru9"&&(n.textContent=o),u=h(a),s=r(a,"DIV",{class:!0});var c=g(s);v=r(c,"DIV",{class:!0});var f=g(v);D=r(f,"DIV",{});var ae=g(D);b=r(ae,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),O(b)!=="svelte-p9rvsg"&&(b.textContent=Y),J=h(ae),w=r(ae,"INPUT",{id:!0,placeholder:!0,class:!0}),ae.forEach(p),Z=h(f),j=r(f,"DIV",{});var ge=g(j);L=r(ge,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),O(L)!=="svelte-qokmn0"&&(L.textContent=ue),ce=h(ge),N=r(ge,"INPUT",{id:!0,inputmode:!0,placeholder:!0,class:!0}),ge.forEach(p),de=h(f),F=r(f,"DIV",{});var Ce=g(F);B=r(Ce,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),O(B)!=="svelte-1p5q6ju"&&(B.textContent=he),fe=h(Ce),k=r(Ce,"INPUT",{id:!0,placeholder:!0,class:!0}),Ce.forEach(p),f.forEach(p),pe=h(c),V=r(c,"DIV",{class:!0});var oe=g(V);d=r(oe,"DIV",{});var be=g(d);m=r(be,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),O(m)!=="svelte-1pesgvy"&&(m.textContent=U),z=h(be),G=r(be,"INPUT",{id:!0,type:!0,accept:!0,class:!0}),be.forEach(p),Ue=h(oe),$=r(oe,"DIV",{});var we=g($);M=r(we,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),O(M)!=="svelte-galfm8"&&(M.textContent=Ye),Pe=h(we),y=r(we,"INPUT",{id:!0,placeholder:!0,class:!0}),we.forEach(p),ke=h(oe),ee=r(oe,"DIV",{});var Ee=g(ee);Q=r(Ee,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),O(Q)!=="svelte-m1ytxa"&&(Q.textContent=Ge),Ve=h(Ee),P=r(Ee,"SELECT",{id:!0,class:!0});var Je=g(P);H=r(Je,"OPTION",{"data-svelte-h":!0}),O(H)!=="svelte-7musmw"&&(H.textContent=Me);for(let Fe=0;Fe<C.length;Fe+=1)C[Fe].l(Je);Je.forEach(p),Ee.forEach(p),oe.forEach(p),Se=h(c),R=r(c,"DIV",{class:!0});var Ie=g(R);te=r(Ie,"DIV",{});var De=g(te);W=r(De,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),O(W)!=="svelte-1v632oe"&&(W.textContent=Qe),je=h(De),q=r(De,"INPUT",{id:!0,placeholder:!0,class:!0}),De.forEach(p),Ae=h(Ie),le=r(Ie,"DIV",{});var Le=g(le);X=r(Le,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),O(X)!=="svelte-s5v501"&&(X.textContent=Re),Oe=h(Le),x=r(Le,"INPUT",{id:!0,placeholder:!0,class:!0}),Le.forEach(p),Ie.forEach(p),Be=h(c),S=r(c,"DIV",{class:!0});var re=g(S);K=r(re,"BUTTON",{class:!0});var Ze=g(K);_e=Te(Ze,ve),Ze.forEach(p),ye=h(re),E&&E.l(re),me=h(re),I&&I.l(re),re.forEach(p),qe=h(c),se=r(c,"P",{class:!0,"data-svelte-h":!0}),O(se)!=="svelte-1nweog4"&&(se.textContent=We),c.forEach(p),this.h()},h(){t(n,"class","text-xl mb-4"),t(b,"for","tcode"),t(b,"class","svelte-7lwlo8"),t(w,"id","tcode"),t(w,"placeholder","e.g. fbise9math"),t(w,"class","svelte-7lwlo8"),t(L,"for","chapter"),t(L,"class","svelte-7lwlo8"),t(N,"id","chapter"),t(N,"inputmode","numeric"),t(N,"placeholder","e.g. 11"),t(N,"class","svelte-7lwlo8"),t(B,"for","exercise"),t(B,"class","svelte-7lwlo8"),t(k,"id","exercise"),t(k,"placeholder","e.g. 1.1"),t(k,"class","svelte-7lwlo8"),t(v,"class","grid gap-3 md:grid-cols-3 svelte-7lwlo8"),t(m,"for","file"),t(m,"class","svelte-7lwlo8"),t(G,"id","file"),t(G,"type","file"),t(G,"accept","application/json,.json"),t(G,"class","svelte-7lwlo8"),t(M,"for","filename"),t(M,"class","svelte-7lwlo8"),t(y,"id","filename"),t(y,"placeholder","auto from file"),t(y,"class","svelte-7lwlo8"),t(Q,"for","status"),t(Q,"class","svelte-7lwlo8"),H.__value="",T(H,H.__value),t(P,"id","status"),t(P,"class","svelte-7lwlo8"),l[6]===void 0&&dt(()=>l[18].call(P)),t(V,"class","grid gap-3 md:grid-cols-3 svelte-7lwlo8"),t(W,"for","description"),t(W,"class","svelte-7lwlo8"),t(q,"id","description"),t(q,"placeholder","optional"),t(q,"class","svelte-7lwlo8"),t(X,"for","tags"),t(X,"class","svelte-7lwlo8"),t(x,"id","tags"),t(x,"placeholder","algebra, basics"),t(x,"class","svelte-7lwlo8"),t(R,"class","grid gap-3 md:grid-cols-2 svelte-7lwlo8"),K.disabled=l[7],t(K,"class","svelte-7lwlo8"),t(S,"class","flex items-center gap-3 svelte-7lwlo8"),t(se,"class","text-xs opacity-70 svelte-7lwlo8"),t(s,"class","space-y-4 svelte-7lwlo8")},m(a,c){ie(a,n,c),ie(a,u,c),ie(a,s,c),e(s,v),e(v,D),e(D,b),e(D,J),e(D,w),T(w,l[0]),e(v,Z),e(v,j),e(j,L),e(j,ce),e(j,N),T(N,l[1]),e(v,de),e(v,F),e(F,B),e(F,fe),e(F,k),T(k,l[2]),e(s,pe),e(s,V),e(V,d),e(d,m),e(d,z),e(d,G),e(V,Ue),e(V,$),e($,M),e($,Pe),e($,y),T(y,l[3]),e(V,ke),e(V,ee),e(ee,Q),e(ee,Ve),e(ee,P),e(P,H);for(let f=0;f<C.length;f+=1)C[f]&&C[f].m(P,null);$e(P,l[6],!0),e(s,Se),e(s,R),e(R,te),e(te,W),e(te,je),e(te,q),T(q,l[4]),e(R,Ae),e(R,le),e(le,X),e(le,Oe),e(le,x),T(x,l[5]),e(s,Be),e(s,S),e(S,K),e(K,_e),e(S,ye),E&&E.m(S,null),e(S,me),I&&I.m(S,null),e(s,qe),e(s,se),xe||(Xe=[A(w,"input",l[14]),A(N,"input",l[15]),A(k,"input",l[16]),A(G,"change",l[11]),A(y,"input",l[17]),A(P,"change",l[18]),A(q,"input",l[19]),A(x,"input",l[20]),A(K,"click",ct(l[13])),A(s,"drop",l[12]),A(s,"dragover",vt)],xe=!0)},p(a,[c]){if(c&1&&w.value!==a[0]&&T(w,a[0]),c&2&&N.value!==a[1]&&T(N,a[1]),c&4&&k.value!==a[2]&&T(k,a[2]),c&8&&y.value!==a[3]&&T(y,a[3]),c&1024){ne=et(a[10]);let f;for(f=0;f<ne.length;f+=1){const ae=tt(a,ne,f);C[f]?C[f].p(ae,c):(C[f]=lt(ae),C[f].c(),C[f].m(P,null))}for(;f<C.length;f+=1)C[f].d(1);C.length=ne.length}c&1088&&$e(P,a[6]),c&16&&q.value!==a[4]&&T(q,a[4]),c&32&&x.value!==a[5]&&T(x,a[5]),c&128&&ve!==(ve=a[7]?"Uploading…":"Upload JSON")&&Ke(_e,ve),c&128&&(K.disabled=a[7]),a[8]?E?E.p(a,c):(E=st(a),E.c(),E.m(S,me)):E&&(E.d(1),E=null),a[9]?I?I.p(a,c):(I=at(a),I.c(),I.m(S,null)):I&&(I.d(1),I=null)},i:He,o:He,d(a){a&&(p(n),p(u),p(s)),it(C,a),E&&E.d(),I&&I.d(),xe=!1,ut(Xe)}}}function ze(l){return(l||"").replace(/\.json$/i,"").trim().toLowerCase().replace(/[^a-z0-9_-]+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")}function vt(l){l.preventDefault()}function ht(l,n,o){let u="",s="",v="",D=null,b="",Y="",J="",w="",Z=!1,j="",L="";const ue=["draft","ready","published","archived"];function ce(d){var U,z;const m=((z=(U=d.target)==null?void 0:U.files)==null?void 0:z[0])??null;D=m,o(3,b=m?ze(m.name):"")}function N(d){var U,z;d.preventDefault();const m=((z=(U=d.dataTransfer)==null?void 0:U.files)==null?void 0:z[0])??null;D=m,o(3,b=m?ze(m.name):"")}async function de(){if(o(9,L=""),o(8,j=""),!D){o(9,L="Pick a .json file.");return}if(!/\.json$/i.test(D.name)){o(9,L="Only .json files allowed.");return}if(!u||!s||!v){o(9,L="tcode, chapter, exercise are required.");return}o(7,Z=!0);try{const d=new FormData;d.append("tcode",u.trim()),d.append("chapter",String(parseInt(s,10))),d.append("exercise",v.trim()),d.append("file",D),d.append("filename",ze(b||D.name)),Y&&d.append("description",Y),J&&d.append("tags",J),w&&d.append("status",w);const m=await fetch("/admin/upload_json",{method:"POST",body:d}),U=await m.json();if(!m.ok)throw new Error((U==null?void 0:U.error)||"Upload failed");o(8,j=`Uploaded ✓ (${U.filename})`),D=null,o(3,b=""),(document.getElementById("file")||{}).value=""}catch(d){o(9,L=d.message||"Error")}finally{o(7,Z=!1)}}function F(){u=this.value,o(0,u)}function B(){s=this.value,o(1,s)}function he(){v=this.value,o(2,v)}function fe(){b=this.value,o(3,b)}function k(){w=ft(this),o(6,w),o(10,ue)}function pe(){Y=this.value,o(4,Y)}function V(){J=this.value,o(5,J)}return[u,s,v,b,Y,J,w,Z,j,L,ue,ce,N,de,F,B,he,fe,k,pe,V]}class Ct extends nt{constructor(n){super(),ot(this,n,ht,pt,rt,{})}}export{Ct as component};
