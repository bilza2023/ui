import{S as re,i as se,s as oe,d as _,x as jt,F as ae,E as ie,t as zt,a as Jt,G as Y,I as Kt,P as ne,y as Qt,e as rt,o as e,J as Et,X as ue,f,K as ce,z as Wt,q as C,j as h,k as y,B as R,A as Xt,v as T,l as m,m as et,p as U,r as V,L as de,n as fe,R as Yt}from"../chunks/Z9DZtfMg.js";import{e as Nt}from"../chunks/DtyEnmTo.js";import"../chunks/IHki7fMi.js";import{i as he,a as me,p as pe,b as _e}from"../chunks/29W-Tj8B.js";/* empty css                *//* empty css                */import{N as ve}from"../chunks/BItVA5Ku.js";import{A as be}from"../chunks/-hQ6QV1S.js";function Ee(l){const t=JSON.parse(l);return t.data&&(t.data=pe(t.data,_e.decoders)),t}function Ut(l){return HTMLElement.prototype.cloneNode.call(l)}function ge(l,t=()=>{}){const n=async({action:d,result:i,reset:u=!0,invalidateAll:c=!0})=>{i.type==="success"&&(u&&HTMLFormElement.prototype.reset.call(l),c&&await he()),(location.origin+location.pathname===d.origin+d.pathname||i.type==="redirect"||i.type==="error")&&await me(i)};async function s(d){var G,B,g,Z,I;if(((G=d.submitter)!=null&&G.hasAttribute("formmethod")?d.submitter.formMethod:Ut(l).method)!=="post")return;d.preventDefault();const u=new URL((B=d.submitter)!=null&&B.hasAttribute("formaction")?d.submitter.formAction:Ut(l).action),c=(g=d.submitter)!=null&&g.hasAttribute("formenctype")?d.submitter.formEnctype:Ut(l).enctype,a=new FormData(l),r=(Z=d.submitter)==null?void 0:Z.getAttribute("name");r&&a.append(r,((I=d.submitter)==null?void 0:I.getAttribute("value"))??"");const E=new AbortController;let p=!1;const L=await t({action:u,cancel:()=>p=!0,controller:E,formData:a,formElement:l,submitter:d.submitter})??n;if(p)return;let A;try{const w=new Headers({accept:"application/json","x-sveltekit-action":"true"});c!=="multipart/form-data"&&w.set("Content-Type",/^(:?application\/x-www-form-urlencoded|text\/plain)$/.test(c)?c:"application/x-www-form-urlencoded");const $=c==="multipart/form-data"?a:new URLSearchParams(a),v=await fetch(u,{method:"POST",headers:w,cache:"no-store",body:$,signal:E.signal});A=Ee(await v.text()),A.type==="error"&&(A.status=v.status)}catch(w){if((w==null?void 0:w.name)==="AbortError")return;A={type:"error",error:w}}await L({action:u,formData:a,formElement:l,update:w=>n({action:u,result:A,reset:w==null?void 0:w.reset,invalidateAll:w==null?void 0:w.invalidateAll}),result:A})}return HTMLFormElement.prototype.addEventListener.call(l,"submit",s),{destroy(){HTMLFormElement.prototype.removeEventListener.call(l,"submit",s)}}}function Zt(l,t,n){const s=l.slice();return s[14]=t[n],s}function $t(l,t,n){const s=l.slice();return s[17]=t[n],s}function te(l){let t,n=l[17].tcodeName+"",s,d,i=l[17].description+"",u,c;return{c(){t=m("option"),s=V(n),d=V(" — "),u=V(i),this.h()},l(a){t=h(a,"OPTION",{});var r=y(t);s=U(r,n),d=U(r," — "),u=U(r,i),r.forEach(_),this.h()},h(){t.__value=c=l[17].tcodeName,Y(t,t.__value)},m(a,r){rt(a,t,r),e(t,s),e(t,d),e(t,u)},p(a,r){r&1&&n!==(n=a[17].tcodeName+"")&&et(s,n),r&1&&i!==(i=a[17].description+"")&&et(u,i),r&1&&c!==(c=a[17].tcodeName)&&(t.__value=c,Y(t,t.__value))},d(a){a&&_(t)}}}function ee(l){let t,n,s,d=l[6].email+"",i;return{c(){t=m("p"),n=V("Selected user: "),s=m("strong"),i=V(d),this.h()},l(u){t=h(u,"P",{class:!0});var c=y(t);n=U(c,"Selected user: "),s=h(c,"STRONG",{});var a=y(s);i=U(a,d),a.forEach(_),c.forEach(_),this.h()},h(){f(t,"class","hint")},m(u,c){rt(u,t,c),e(t,n),e(t,s),e(s,i)},p(u,c){c&64&&d!==(d=u[6].email+"")&&et(i,d)},d(u){u&&_(t)}}}function Ce(l){let t,n,s,d="<tr><th>Tcode</th> <th>Start</th> <th>Duration</th> <th>Expires</th> <th>Status</th> <th>Remaining</th> <th>Quick</th></tr>",i,u,c=Nt(l[5]),a=[];for(let r=0;r<c.length;r+=1)a[r]=le(Zt(l,c,r));return{c(){t=m("div"),n=m("table"),s=m("thead"),s.innerHTML=d,i=T(),u=m("tbody");for(let r=0;r<a.length;r+=1)a[r].c();this.h()},l(r){t=h(r,"DIV",{class:!0});var E=y(t);n=h(E,"TABLE",{class:!0});var p=y(n);s=h(p,"THEAD",{"data-svelte-h":!0}),R(s)!=="svelte-m4d6p2"&&(s.innerHTML=d),i=C(p),u=h(p,"TBODY",{});var S=y(u);for(let L=0;L<a.length;L+=1)a[L].l(S);S.forEach(_),p.forEach(_),E.forEach(_),this.h()},h(){f(n,"class","taleemTable"),f(t,"class","taleemTableWrap svelte-12n6ptx")},m(r,E){rt(r,t,E),e(t,n),e(n,s),e(n,i),e(n,u);for(let p=0;p<a.length;p+=1)a[p]&&a[p].m(u,null)},p(r,E){if(E&160){c=Nt(r[5]);let p;for(p=0;p<c.length;p+=1){const S=Zt(r,c,p);a[p]?a[p].p(S,E):(a[p]=le(S),a[p].c(),a[p].m(u,null))}for(;p<a.length;p+=1)a[p].d(1);a.length=c.length}},d(r){r&&_(t),ae(a,r)}}}function Te(l){let t,n,s,d=l[6].email+"",i,u;return{c(){t=m("p"),n=V("No subscriptions yet for "),s=m("strong"),i=V(d),u=V("."),this.h()},l(c){t=h(c,"P",{class:!0});var a=y(t);n=U(a,"No subscriptions yet for "),s=h(a,"STRONG",{});var r=y(s);i=U(r,d),r.forEach(_),u=U(a,"."),a.forEach(_),this.h()},h(){f(t,"class","muted")},m(c,a){rt(c,t,a),e(t,n),e(t,s),e(s,i),e(t,u)},p(c,a){a&64&&d!==(d=c[6].email+"")&&et(i,d)},d(c){c&&_(t)}}}function ye(l){let t,n="Look up a user to view their subscriptions.";return{c(){t=m("p"),t.textContent=n,this.h()},l(s){t=h(s,"P",{class:!0,"data-svelte-h":!0}),R(t)!=="svelte-k5u1c"&&(t.textContent=n),this.h()},h(){f(t,"class","muted")},m(s,d){rt(s,t,d)},p:fe,d(s){s&&_(t)}}}function le(l){var mt,H;let t,n,s=l[14].tcode+"",d,i,u,c=((mt=l[14].start_date)==null?void 0:mt.slice(0,10))+"",a,r,E,p=l[14].duration+"",S,L,A,G,B=((H=l[14].expiresAt)==null?void 0:H.slice(0,10))+"",g,Z,I,w=l[14].status+"",$,v,z,st=l[14].status==="active"?`${l[14].remainingDays}d`:"-",ot,J,j,Q,ht="Renew…",M,it,K,tt;function Ct(){return l[13](l[14])}return{c(){t=m("tr"),n=m("td"),d=V(s),i=T(),u=m("td"),a=V(c),r=T(),E=m("td"),S=V(p),L=V("d"),A=T(),G=m("td"),g=V(B),Z=T(),I=m("td"),$=V(w),v=T(),z=m("td"),ot=V(st),J=T(),j=m("td"),Q=m("button"),Q.textContent=ht,M=T(),this.h()},l(N){t=h(N,"TR",{class:!0});var b=y(t);n=h(b,"TD",{});var lt=y(n);d=U(lt,s),lt.forEach(_),i=C(b),u=h(b,"TD",{});var F=y(u);a=U(F,c),F.forEach(_),r=C(b),E=h(b,"TD",{});var W=y(E);S=U(W,p),L=U(W,"d"),W.forEach(_),A=C(b),G=h(b,"TD",{});var gt=y(G);g=U(gt,B),gt.forEach(_),Z=C(b),I=h(b,"TD",{class:!0});var pt=y(I);$=U(pt,w),pt.forEach(_),v=C(b),z=h(b,"TD",{});var O=y(z);ot=U(O,st),O.forEach(_),J=C(b),j=h(b,"TD",{});var _t=y(j);Q=h(_t,"BUTTON",{type:!0,"data-svelte-h":!0}),R(Q)!=="svelte-pcbgtz"&&(Q.textContent=ht),_t.forEach(_),M=C(b),b.forEach(_),this.h()},h(){f(I,"class","status svelte-12n6ptx"),f(Q,"type","button"),f(t,"class",it=Yt(l[14].status)+" svelte-12n6ptx")},m(N,b){rt(N,t,b),e(t,n),e(n,d),e(t,i),e(t,u),e(u,a),e(t,r),e(t,E),e(E,S),e(E,L),e(t,A),e(t,G),e(G,g),e(t,Z),e(t,I),e(I,$),e(t,v),e(t,z),e(z,ot),e(t,J),e(t,j),e(j,Q),e(t,M),K||(tt=Et(Q,"click",Ct),K=!0)},p(N,b){var lt,F;l=N,b&32&&s!==(s=l[14].tcode+"")&&et(d,s),b&32&&c!==(c=((lt=l[14].start_date)==null?void 0:lt.slice(0,10))+"")&&et(a,c),b&32&&p!==(p=l[14].duration+"")&&et(S,p),b&32&&B!==(B=((F=l[14].expiresAt)==null?void 0:F.slice(0,10))+"")&&et(g,B),b&32&&w!==(w=l[14].status+"")&&et($,w),b&32&&st!==(st=l[14].status==="active"?`${l[14].remainingDays}d`:"-")&&et(ot,st),b&32&&it!==(it=Yt(l[14].status)+" svelte-12n6ptx")&&f(t,"class",it)},d(N){N&&_(t),K=!1,tt()}}}function De(l){let t,n,s,d,i,u,c="Subscriptions (Admin)",a,r,E,p="Find User",S,L,A,G="Email",B,g,Z,I,w='<button type="submit" class="primary">Load</button>',$,v,z,st="Grant Subscription",ot,J,j,Q="Email",ht,M,it,K,tt,Ct="Tcode",mt,H,N,b="Select tcode…",lt,F,W,gt="Duration (days)",pt,O,_t,ut,ct,Vt="Start Date (optional)",St,at,It,dt,Bt='<button type="submit" class="primary" formaction="?/grant">Grant</button>',Ht,Pt,nt,vt,Ft="User Subscriptions",Mt,Tt,Ot,qt;t=new ve({}),s=new be({});let bt=Nt(l[0].tcodes),P=[];for(let o=0;o<bt.length;o+=1)P[o]=te($t(l,bt,o));let x=l[6]&&ee(l);function Gt(o,D){return o[6]?o[5].length?Ce:Te:ye}let yt=Gt(l),X=yt(l);return{c(){Xt(t.$$.fragment),n=T(),Xt(s.$$.fragment),d=T(),i=m("div"),u=m("h1"),u.textContent=c,a=T(),r=m("form"),E=m("h2"),E.textContent=p,S=T(),L=m("div"),A=m("label"),A.textContent=G,B=T(),g=m("input"),Z=T(),I=m("div"),I.innerHTML=w,$=T(),v=m("form"),z=m("h2"),z.textContent=st,ot=T(),J=m("div"),j=m("label"),j.textContent=Q,ht=T(),M=m("input"),it=T(),K=m("div"),tt=m("label"),tt.textContent=Ct,mt=T(),H=m("select"),N=m("option"),N.textContent=b;for(let o=0;o<P.length;o+=1)P[o].c();lt=T(),F=m("div"),W=m("label"),W.textContent=gt,pt=T(),O=m("input"),_t=T(),ut=m("div"),ct=m("label"),ct.textContent=Vt,St=T(),at=m("input"),It=T(),dt=m("div"),dt.innerHTML=Bt,Ht=T(),x&&x.c(),Pt=T(),nt=m("div"),vt=m("h2"),vt.textContent=Ft,Mt=T(),X.c(),this.h()},l(o){Wt(t.$$.fragment,o),n=C(o),Wt(s.$$.fragment,o),d=C(o),i=h(o,"DIV",{class:!0});var D=y(i);u=h(D,"H1",{class:!0,"data-svelte-h":!0}),R(u)!=="svelte-p1n89a"&&(u.textContent=c),a=C(D),r=h(D,"FORM",{class:!0,method:!0});var k=y(r);E=h(k,"H2",{"data-svelte-h":!0}),R(E)!=="svelte-1jzegy0"&&(E.textContent=p),S=C(k),L=h(k,"DIV",{class:!0});var ft=y(L);A=h(ft,"LABEL",{for:!0,"data-svelte-h":!0}),R(A)!=="svelte-1p9d3fm"&&(A.textContent=G),B=C(ft),g=h(ft,"INPUT",{id:!0,name:!0,type:!0,placeholder:!0}),ft.forEach(_),Z=C(k),I=h(k,"DIV",{class:!0,"data-svelte-h":!0}),R(I)!=="svelte-1upttmb"&&(I.innerHTML=w),k.forEach(_),$=C(D),v=h(D,"FORM",{class:!0,method:!0});var q=y(v);z=h(q,"H2",{"data-svelte-h":!0}),R(z)!=="svelte-fpr8r9"&&(z.textContent=st),ot=C(q),J=h(q,"DIV",{class:!0});var Dt=y(J);j=h(Dt,"LABEL",{for:!0,"data-svelte-h":!0}),R(j)!=="svelte-fg5qb"&&(j.textContent=Q),ht=C(Dt),M=h(Dt,"INPUT",{id:!0,name:!0,type:!0,placeholder:!0}),Dt.forEach(_),it=C(q),K=h(q,"DIV",{class:!0});var kt=y(K);tt=h(kt,"LABEL",{for:!0,"data-svelte-h":!0}),R(tt)!=="svelte-6p13rk"&&(tt.textContent=Ct),mt=C(kt),H=h(kt,"SELECT",{id:!0,name:!0});var xt=y(H);N=h(xt,"OPTION",{"data-svelte-h":!0}),R(N)!=="svelte-11x0drw"&&(N.textContent=b);for(let Rt=0;Rt<P.length;Rt+=1)P[Rt].l(xt);xt.forEach(_),kt.forEach(_),lt=C(q),F=h(q,"DIV",{class:!0});var wt=y(F);W=h(wt,"LABEL",{for:!0,"data-svelte-h":!0}),R(W)!=="svelte-1e9580w"&&(W.textContent=gt),pt=C(wt),O=h(wt,"INPUT",{id:!0,name:!0,type:!0,min:!0,step:!0}),wt.forEach(_),_t=C(q),ut=h(q,"DIV",{class:!0});var Lt=y(ut);ct=h(Lt,"LABEL",{for:!0,"data-svelte-h":!0}),R(ct)!=="svelte-zj7jm1"&&(ct.textContent=Vt),St=C(Lt),at=h(Lt,"INPUT",{id:!0,name:!0,type:!0}),Lt.forEach(_),It=C(q),dt=h(q,"DIV",{class:!0,"data-svelte-h":!0}),R(dt)!=="svelte-ffhk7s"&&(dt.innerHTML=Bt),Ht=C(q),x&&x.l(q),q.forEach(_),Pt=C(D),nt=h(D,"DIV",{class:!0});var At=y(nt);vt=h(At,"H2",{"data-svelte-h":!0}),R(vt)!=="svelte-1mkkoa3"&&(vt.textContent=Ft),Mt=C(At),X.l(At),At.forEach(_),D.forEach(_),this.h()},h(){f(u,"class","svelte-12n6ptx"),f(A,"for","email"),f(g,"id","email"),f(g,"name","email"),f(g,"type","email"),f(g,"placeholder","user@example.com"),g.required=!0,f(L,"class","row"),f(I,"class","actions"),f(r,"class","form"),f(r,"method","GET"),f(j,"for","grant-email"),f(M,"id","grant-email"),f(M,"name","email"),f(M,"type","email"),f(M,"placeholder","user@example.com"),M.required=!0,f(J,"class","row"),f(tt,"for","tcode"),N.__value="",Y(N,N.__value),N.disabled=!0,N.selected=!0,f(H,"id","tcode"),f(H,"name","tcode"),H.required=!0,l[2]===void 0&&ce(()=>l[10].call(H)),f(K,"class","row"),f(W,"for","duration"),f(O,"id","duration"),f(O,"name","duration"),f(O,"type","number"),f(O,"min","1"),f(O,"step","1"),O.required=!0,f(F,"class","row"),f(ct,"for","startDate"),f(at,"id","startDate"),f(at,"name","startDate"),f(at,"type","date"),f(ut,"class","row"),f(dt,"class","actions"),f(v,"class","form"),f(v,"method","POST"),f(nt,"class","form svelte-12n6ptx"),f(i,"class","page svelte-12n6ptx")},m(o,D){Qt(t,o,D),rt(o,n,D),Qt(s,o,D),rt(o,d,D),rt(o,i,D),e(i,u),e(i,a),e(i,r),e(r,E),e(r,S),e(r,L),e(L,A),e(L,B),e(L,g),Y(g,l[1]),e(r,Z),e(r,I),e(i,$),e(i,v),e(v,z),e(v,ot),e(v,J),e(J,j),e(J,ht),e(J,M),Y(M,l[1]),e(v,it),e(v,K),e(K,tt),e(K,mt),e(K,H),e(H,N);for(let k=0;k<P.length;k+=1)P[k]&&P[k].m(H,null);Kt(H,l[2],!0),e(v,lt),e(v,F),e(F,W),e(F,pt),e(F,O),Y(O,l[3]),e(v,_t),e(v,ut),e(ut,ct),e(ut,St),e(ut,at),Y(at,l[4]),e(v,It),e(v,dt),e(v,Ht),x&&x.m(v,null),e(i,Pt),e(i,nt),e(nt,vt),e(nt,Mt),X.m(nt,null),Tt=!0,Ot||(qt=[Et(g,"input",l[8]),Et(M,"input",l[9]),Et(H,"change",l[10]),Et(O,"input",l[11]),Et(at,"input",l[12]),ue(ge.call(null,v))],Ot=!0)},p(o,[D]){if(D&2&&g.value!==o[1]&&Y(g,o[1]),D&2&&M.value!==o[1]&&Y(M,o[1]),D&1){bt=Nt(o[0].tcodes);let k;for(k=0;k<bt.length;k+=1){const ft=$t(o,bt,k);P[k]?P[k].p(ft,D):(P[k]=te(ft),P[k].c(),P[k].m(H,null))}for(;k<P.length;k+=1)P[k].d(1);P.length=bt.length}D&5&&Kt(H,o[2]),D&8&&ne(O.value)!==o[3]&&Y(O,o[3]),D&16&&Y(at,o[4]),o[6]?x?x.p(o,D):(x=ee(o),x.c(),x.m(v,null)):x&&(x.d(1),x=null),yt===(yt=Gt(o))&&X?X.p(o,D):(X.d(1),X=yt(o),X&&(X.c(),X.m(nt,null)))},i(o){Tt||(Jt(t.$$.fragment,o),Jt(s.$$.fragment,o),Tt=!0)},o(o){zt(t.$$.fragment,o),zt(s.$$.fragment,o),Tt=!1},d(o){o&&(_(n),_(d),_(i)),jt(t,o),jt(s,o),ae(P,o),x&&x.d(),X.d(),Ot=!1,ie(qt)}}}function ke(l,t,n){let s,d,{data:i}=t,u=i.selectedEmail??"",c="",a=30,r="";function E(g){n(2,c=g.tcode),n(3,a=30),n(4,r="")}function p(){u=this.value,n(1,u)}function S(){u=this.value,n(1,u)}function L(){c=de(this),n(2,c),n(0,i)}function A(){a=ne(this.value),n(3,a)}function G(){r=this.value,n(4,r)}const B=g=>E(g);return l.$$set=g=>{"data"in g&&n(0,i=g.data)},l.$$.update=()=>{l.$$.dirty&1&&n(6,s=i.selectedUser),l.$$.dirty&1&&n(5,d=i.subscriptions??[])},[i,u,c,a,r,d,s,E,p,S,L,A,G,B]}class Me extends re{constructor(t){super(),se(this,t,ke,De,oe,{data:0})}}export{Me as component};
