import{S as Cl,i as kl,s as Sl,d as _,x as ll,F as vt,E as Tl,t as sl,a as nl,I as ye,m as $,R as rl,f,G as M,y as al,e as I,o as a,J,T as Il,K as ht,z as ol,q as E,j as u,k as v,B as O,p as P,A as il,v as b,l as d,r as V,n as mt,L as pt,M as cl}from"../chunks/Z9DZtfMg.js";import{e as Ce}from"../chunks/DtyEnmTo.js";import"../chunks/IHki7fMi.js";import{N as Ll}from"../chunks/BItVA5Ku.js";import{A as Dl}from"../chunks/-hQ6QV1S.js";/* empty css                */import{l as Nl,g as Ol,c as Pl,a as Vl}from"../chunks/B9_b_OnU.js";function fl(l,e,t){const s=l.slice();return s[31]=e[t],s}function ul(l,e,t){const s=l.slice();return s[34]=e[t],s}function dl(l,e,t){const s=l.slice();return s[37]=e[t],s}function _l(l,e,t){const s=l.slice();return s[40]=e[t],s}function wl(l){let e,t=Ce(l[15]),s=[];for(let n=0;n<t.length;n+=1)s[n]=hl(_l(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=cl()},l(n){for(let i=0;i<s.length;i+=1)s[i].l(n);e=cl()},m(n,i){for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(n,i);I(n,e,i)},p(n,i){if(i[0]&32768){t=Ce(n[15]);let o;for(o=0;o<t.length;o+=1){const C=_l(n,t,o);s[o]?s[o].p(C,i):(s[o]=hl(C),s[o].c(),s[o].m(e.parentNode,e))}for(;o<s.length;o+=1)s[o].d(1);s.length=t.length}},d(n){n&&_(e),vt(s,n)}}}function Al(l){let e,t="No subjects registered";return{c(){e=d("option"),e.textContent=t,this.h()},l(s){e=u(s,"OPTION",{"data-svelte-h":!0}),O(e)!=="svelte-11m4iz6"&&(e.textContent=t),this.h()},h(){e.__value="",M(e,e.__value)},m(s,n){I(s,e,n)},p:mt,d(s){s&&_(e)}}}function hl(l){let e,t=l[40].tcodeName+"",s;return{c(){e=d("option"),s=V(t),this.h()},l(n){e=u(n,"OPTION",{});var i=v(e);s=P(i,t),i.forEach(_),this.h()},h(){e.__value=l[40].tcodeName,M(e,e.__value)},m(n,i){I(n,e,i),a(e,s)},p:mt,d(n){n&&_(e)}}}function pl(l){let e,t,s=String(l[37].number).padStart(2,"0")+"",n,i,o=l[37].name+"",C,T,h;return{c(){e=d("option"),t=V("Ch "),n=V(s),i=V(" — "),C=V(o),T=b(),this.h()},l(g){e=u(g,"OPTION",{});var m=v(e);t=P(m,"Ch "),n=P(m,s),i=P(m," — "),C=P(m,o),T=E(m),m.forEach(_),this.h()},h(){e.__value=h=l[37].filename,M(e,e.__value)},m(g,m){I(g,e,m),a(e,t),a(e,n),a(e,i),a(e,C),a(e,T)},p(g,m){m[0]&2&&s!==(s=String(g[37].number).padStart(2,"0")+"")&&$(n,s),m[0]&2&&o!==(o=g[37].name+"")&&$(C,o),m[0]&2&&h!==(h=g[37].filename)&&(e.__value=h,M(e,e.__value))},d(g){g&&_(e)}}}function vl(l){let e,t,s,n;return{c(){e=d("small"),t=V("Chapter #: "),s=d("strong"),n=V(l[5]),this.h()},l(i){e=u(i,"SMALL",{class:!0});var o=v(e);t=P(o,"Chapter #: "),s=u(o,"STRONG",{});var C=v(s);n=P(C,l[5]),C.forEach(_),o.forEach(_),this.h()},h(){f(e,"class","hint")},m(i,o){I(i,e,o),a(e,t),a(e,s),a(s,n)},p(i,o){o[0]&32&&$(n,i[5])},d(i){i&&_(e)}}}function ml(l){let e,t=l[34].name+"",s,n;return{c(){e=d("option"),s=V(t),this.h()},l(i){e=u(i,"OPTION",{});var o=v(e);s=P(o,t),o.forEach(_),this.h()},h(){e.__value=n=l[34].filename,M(e,e.__value)},m(i,o){I(i,e,o),a(e,s)},p(i,o){o[0]&8&&t!==(t=i[34].name+"")&&$(s,t),o[0]&8&&n!==(n=i[34].filename)&&(e.__value=n,M(e,e.__value))},d(i){i&&_(e)}}}function jl(l){let e,t="Drop your .json here",s,n,i="or click to choose";return{c(){e=d("strong"),e.textContent=t,s=b(),n=d("small"),n.textContent=i,this.h()},l(o){e=u(o,"STRONG",{class:!0,"data-svelte-h":!0}),O(e)!=="svelte-ncr352"&&(e.textContent=t),s=E(o),n=u(o,"SMALL",{class:!0,"data-svelte-h":!0}),O(n)!=="svelte-12xg281"&&(n.textContent=i),this.h()},h(){f(e,"class","svelte-9yylr6"),f(n,"class","svelte-9yylr6")},m(o,C){I(o,e,C),I(o,s,C),I(o,n,C)},p:mt,d(o){o&&(_(e),_(s),_(n))}}}function Bl(l){let e,t=l[6].name+"",s,n,i,o=Math.round(l[6].size/1024)+"",C,T;return{c(){e=d("strong"),s=V(t),n=b(),i=d("small"),C=V(o),T=V(" KB"),this.h()},l(h){e=u(h,"STRONG",{class:!0});var g=v(e);s=P(g,t),g.forEach(_),n=E(h),i=u(h,"SMALL",{class:!0});var m=v(i);C=P(m,o),T=P(m," KB"),m.forEach(_),this.h()},h(){f(e,"class","svelte-9yylr6"),f(i,"class","svelte-9yylr6")},m(h,g){I(h,e,g),a(e,s),I(h,n,g),I(h,i,g),a(i,C),a(i,T)},p(h,g){g[0]&64&&t!==(t=h[6].name+"")&&$(s,t),g[0]&64&&o!==(o=Math.round(h[6].size/1024)+"")&&$(C,o)},d(h){h&&(_(e),_(n),_(i))}}}function gl(l){let e,t=l[31]+"",s;return{c(){e=d("option"),s=V(t),this.h()},l(n){e=u(n,"OPTION",{});var i=v(e);s=P(i,t),i.forEach(_),this.h()},h(){e.__value=l[31],M(e,e.__value)},m(n,i){I(n,e,i),a(e,s)},p:mt,d(n){n&&_(e)}}}function El(l){let e,t;return{c(){e=d("div"),t=V(l[12]),this.h()},l(s){e=u(s,"DIV",{class:!0});var n=v(e);t=P(n,l[12]),n.forEach(_),this.h()},h(){f(e,"class","note ok svelte-9yylr6")},m(s,n){I(s,e,n),a(e,t)},p(s,n){n[0]&4096&&$(t,s[12])},d(s){s&&_(e)}}}function bl(l){let e,t;return{c(){e=d("div"),t=V(l[13]),this.h()},l(s){e=u(s,"DIV",{class:!0});var n=v(e);t=P(n,l[13]),n.forEach(_),this.h()},h(){f(e,"class","note err svelte-9yylr6")},m(s,n){I(s,e,n),a(e,t)},p(s,n){n[0]&8192&&$(t,s[13])},d(s){s&&_(e)}}}function Ul(l){let e,t,s,n,i,o,C='<h1 class="svelte-9yylr6">Upload JSON Deck</h1> <p class="svelte-9yylr6">Pick the path, drop your <code class="svelte-9yylr6">.json</code>, add optional meta, then upload.</p>',T,h,g,m,ee="Path",se,w,G,W,we="Tcode",te,z,Ae,R,ne,Ye="Chapter",Je,A,q,ke=l[0]?"Select chapter":"Pick tcode first",je,Be,qe,Ke,le,re,Qe="Exercise",y,k,S,X=l[2]?"Select exercise":"Pick chapter first",Ze,gt,xe,Et,ue,Se,Gt="File",bt,de,F,Te,Rt="⇪",yt,Ie,Ct,_e,$e,kt,he,pe,Le,Ht="Filename (auto)",St,ae,Tt,ve,De,Jt="Status",It,K,oe,qt="(auto)",Lt,me,Ne,Kt="Meta",Dt,ge,Ee,Oe,Qt="Description",Nt,ie,Ot,be,Pe,Wt="Tags (csv)",Pt,ce,Vt,Q,fe,We=l[11]?"Uploading…":"Upload JSON",et,wt,tt,At,Ve,Xt="Tip: Drag &amp; drop a <code>.json</code> file anywhere inside the dashed area above.",Y,jt,Yt;e=new Ll({}),s=new Dl({});function yl(r,p){return r[15].length?wl:Al}let Xe=yl(l)(l),Ue=Ce(l[1]),L=[];for(let r=0;r<Ue.length;r+=1)L[r]=pl(dl(l,Ue,r));let j=l[5]&&vl(l),Me=Ce(l[3]),D=[];for(let r=0;r<Me.length;r+=1)D[r]=ml(ul(l,Me,r));function Zt(r,p){return r[6]?Bl:jl}let lt=Zt(l),Z=lt(l),ze=Ce(l[16]),N=[];for(let r=0;r<ze.length;r+=1)N[r]=gl(fl(l,ze,r));let B=l[12]&&El(l),U=l[13]&&bl(l);return{c(){il(e.$$.fragment),t=b(),il(s.$$.fragment),n=b(),i=d("section"),o=d("header"),o.innerHTML=C,T=b(),h=d("form"),g=d("fieldset"),m=d("legend"),m.textContent=ee,se=b(),w=d("div"),G=d("div"),W=d("label"),W.textContent=we,te=b(),z=d("select"),Xe.c(),Ae=b(),R=d("div"),ne=d("label"),ne.textContent=Ye,Je=b(),A=d("select"),q=d("option"),je=V(ke);for(let r=0;r<L.length;r+=1)L[r].c();qe=b(),j&&j.c(),Ke=b(),le=d("div"),re=d("label"),re.textContent=Qe,y=b(),k=d("select"),S=d("option"),Ze=V(X),gt=b();for(let r=0;r<D.length;r+=1)D[r].c();Et=b(),ue=d("fieldset"),Se=d("legend"),Se.textContent=Gt,bt=b(),de=d("div"),F=d("div"),Te=d("div"),Te.textContent=Rt,yt=b(),Ie=d("div"),Z.c(),Ct=b(),_e=d("input"),kt=b(),he=d("div"),pe=d("div"),Le=d("label"),Le.textContent=Ht,St=b(),ae=d("input"),Tt=b(),ve=d("div"),De=d("label"),De.textContent=Jt,It=b(),K=d("select"),oe=d("option"),oe.textContent=qt;for(let r=0;r<N.length;r+=1)N[r].c();Lt=b(),me=d("fieldset"),Ne=d("legend"),Ne.textContent=Kt,Dt=b(),ge=d("div"),Ee=d("div"),Oe=d("label"),Oe.textContent=Qt,Nt=b(),ie=d("input"),Ot=b(),be=d("div"),Pe=d("label"),Pe.textContent=Wt,Pt=b(),ce=d("input"),Vt=b(),Q=d("div"),fe=d("button"),et=V(We),wt=b(),B&&B.c(),tt=b(),U&&U.c(),At=b(),Ve=d("p"),Ve.innerHTML=Xt,this.h()},l(r){ol(e.$$.fragment,r),t=E(r),ol(s.$$.fragment,r),n=E(r),i=u(r,"SECTION",{class:!0});var p=v(i);o=u(p,"HEADER",{class:!0,"data-svelte-h":!0}),O(o)!=="svelte-1s51uh2"&&(o.innerHTML=C),T=E(p),h=u(p,"FORM",{class:!0});var c=v(h);g=u(c,"FIELDSET",{class:!0});var H=v(g);m=u(H,"LEGEND",{class:!0,"data-svelte-h":!0}),O(m)!=="svelte-13kvvn3"&&(m.textContent=ee),se=E(H),w=u(H,"DIV",{class:!0});var Fe=v(w);G=u(Fe,"DIV",{class:!0});var st=v(G);W=u(st,"LABEL",{for:!0,"data-svelte-h":!0}),O(W)!=="svelte-6p13rk"&&(W.textContent=we),te=E(st),z=u(st,"SELECT",{id:!0});var xt=v(z);Xe.l(xt),xt.forEach(_),st.forEach(_),Ae=E(Fe),R=u(Fe,"DIV",{class:!0});var Ge=v(R);ne=u(Ge,"LABEL",{for:!0,"data-svelte-h":!0}),O(ne)!=="svelte-nkiq2x"&&(ne.textContent=Ye),Je=E(Ge),A=u(Ge,"SELECT",{id:!0});var Bt=v(A);q=u(Bt,"OPTION",{});var $t=v(q);je=P($t,ke),$t.forEach(_);for(let x=0;x<L.length;x+=1)L[x].l(Bt);Bt.forEach(_),qe=E(Ge),j&&j.l(Ge),Ge.forEach(_),Ke=E(Fe),le=u(Fe,"DIV",{class:!0});var nt=v(le);re=u(nt,"LABEL",{for:!0,"data-svelte-h":!0}),O(re)!=="svelte-175yy8x"&&(re.textContent=Qe),y=E(nt),k=u(nt,"SELECT",{id:!0});var Ut=v(k);S=u(Ut,"OPTION",{});var Mt=v(S);Ze=P(Mt,X),gt=E(Mt),Mt.forEach(_);for(let x=0;x<D.length;x+=1)D[x].l(Ut);Ut.forEach(_),nt.forEach(_),Fe.forEach(_),H.forEach(_),Et=E(c),ue=u(c,"FIELDSET",{class:!0});var rt=v(ue);Se=u(rt,"LEGEND",{class:!0,"data-svelte-h":!0}),O(Se)!=="svelte-1iyhln2"&&(Se.textContent=Gt),bt=E(rt),de=u(rt,"DIV",{class:!0});var at=v(de);F=u(at,"DIV",{class:!0,role:!0,tabindex:!0,"aria-label":!0});var Re=v(F);Te=u(Re,"DIV",{class:!0,"data-svelte-h":!0}),O(Te)!=="svelte-j6trfd"&&(Te.textContent=Rt),yt=E(Re),Ie=u(Re,"DIV",{class:!0});var el=v(Ie);Z.l(el),el.forEach(_),Ct=E(Re),_e=u(Re,"INPUT",{id:!0,type:!0,accept:!0,class:!0}),Re.forEach(_),kt=E(at),he=u(at,"DIV",{class:!0});var ot=v(he);pe=u(ot,"DIV",{class:!0});var it=v(pe);Le=u(it,"LABEL",{for:!0,"data-svelte-h":!0}),O(Le)!=="svelte-1c30r00"&&(Le.textContent=Ht),St=E(it),ae=u(it,"INPUT",{id:!0,placeholder:!0}),it.forEach(_),Tt=E(ot),ve=u(ot,"DIV",{class:!0});var ct=v(ve);De=u(ct,"LABEL",{for:!0,"data-svelte-h":!0}),O(De)!=="svelte-15lfxni"&&(De.textContent=Jt),It=E(ct),K=u(ct,"SELECT",{id:!0});var zt=v(K);oe=u(zt,"OPTION",{"data-svelte-h":!0}),O(oe)!=="svelte-7musmw"&&(oe.textContent=qt);for(let x=0;x<N.length;x+=1)N[x].l(zt);zt.forEach(_),ct.forEach(_),ot.forEach(_),at.forEach(_),rt.forEach(_),Lt=E(c),me=u(c,"FIELDSET",{class:!0});var ft=v(me);Ne=u(ft,"LEGEND",{class:!0,"data-svelte-h":!0}),O(Ne)!=="svelte-yagw0p"&&(Ne.textContent=Kt),Dt=E(ft),ge=u(ft,"DIV",{class:!0});var ut=v(ge);Ee=u(ut,"DIV",{class:!0});var dt=v(Ee);Oe=u(dt,"LABEL",{for:!0,"data-svelte-h":!0}),O(Oe)!=="svelte-1tds9bi"&&(Oe.textContent=Qt),Nt=E(dt),ie=u(dt,"INPUT",{id:!0,placeholder:!0}),dt.forEach(_),Ot=E(ut),be=u(ut,"DIV",{class:!0});var _t=v(be);Pe=u(_t,"LABEL",{for:!0,"data-svelte-h":!0}),O(Pe)!=="svelte-gn51pt"&&(Pe.textContent=Wt),Pt=E(_t),ce=u(_t,"INPUT",{id:!0,placeholder:!0}),_t.forEach(_),ut.forEach(_),ft.forEach(_),Vt=E(c),Q=u(c,"DIV",{class:!0});var He=v(Q);fe=u(He,"BUTTON",{class:!0});var tl=v(fe);et=P(tl,We),tl.forEach(_),wt=E(He),B&&B.l(He),tt=E(He),U&&U.l(He),He.forEach(_),At=E(c),Ve=u(c,"P",{class:!0,"data-svelte-h":!0}),O(Ve)!=="svelte-1p0pvel"&&(Ve.innerHTML=Xt),c.forEach(_),p.forEach(_),this.h()},h(){f(o,"class","pagehead svelte-9yylr6"),f(m,"class","svelte-9yylr6"),f(W,"for","tcode"),f(z,"id","tcode"),l[0]===void 0&&ht(()=>l[22].call(z)),f(G,"class","field"),f(ne,"for","chapterSlug"),q.__value="",M(q,q.__value),q.disabled=!0,q.selected=!0,f(A,"id","chapterSlug"),A.disabled=Be=!l[0]||!l[1].length,l[2]===void 0&&ht(()=>l[23].call(A)),f(R,"class","field"),f(re,"for","exerciseSlug"),S.__value="",M(S,S.__value),S.disabled=!0,S.selected=!0,f(k,"id","exerciseSlug"),k.disabled=xe=!l[2]||!l[3].length,l[4]===void 0&&ht(()=>l[24].call(k)),f(le,"class","field"),f(w,"class","form-grid svelte-9yylr6"),f(g,"class","block svelte-9yylr6"),f(Se,"class","svelte-9yylr6"),f(Te,"class","dz-icon svelte-9yylr6"),f(Ie,"class","dz-text svelte-9yylr6"),f(_e,"id","file"),f(_e,"type","file"),f(_e,"accept","application/json,.json"),f(_e,"class","hidden-input svelte-9yylr6"),f(F,"class",$e=rl("dropzone "+(l[14]?"is-dragging":""))+" svelte-9yylr6"),f(F,"role","button"),f(F,"tabindex","0"),f(F,"aria-label","Drop JSON here or click to browse"),f(Le,"for","filename"),f(ae,"id","filename"),f(ae,"placeholder","auto from file"),f(pe,"class","field"),f(De,"for","status"),oe.__value="",M(oe,oe.__value),f(K,"id","status"),l[10]===void 0&&ht(()=>l[27].call(K)),f(ve,"class","field"),f(he,"class","sidegrid svelte-9yylr6"),f(de,"class","dropgrid svelte-9yylr6"),f(ue,"class","block svelte-9yylr6"),f(Ne,"class","svelte-9yylr6"),f(Oe,"for","description"),f(ie,"id","description"),f(ie,"placeholder","optional"),f(Ee,"class","field"),f(Pe,"for","tags"),f(ce,"id","tags"),f(ce,"placeholder","algebra, basics"),f(be,"class","field"),f(ge,"class","form-grid two svelte-9yylr6"),f(me,"class","block svelte-9yylr6"),fe.disabled=l[11],f(fe,"class","primary"),f(Q,"class","actions svelte-9yylr6"),f(Ve,"class","hint"),f(h,"class","form upload-form svelte-9yylr6"),f(i,"class","wrap svelte-9yylr6")},m(r,p){al(e,r,p),I(r,t,p),al(s,r,p),I(r,n,p),I(r,i,p),a(i,o),a(i,T),a(i,h),a(h,g),a(g,m),a(g,se),a(g,w),a(w,G),a(G,W),a(G,te),a(G,z),Xe.m(z,null),ye(z,l[0],!0),a(w,Ae),a(w,R),a(R,ne),a(R,Je),a(R,A),a(A,q),a(q,je);for(let c=0;c<L.length;c+=1)L[c]&&L[c].m(A,null);ye(A,l[2],!0),a(R,qe),j&&j.m(R,null),a(w,Ke),a(w,le),a(le,re),a(le,y),a(le,k),a(k,S),a(S,Ze),a(S,gt);for(let c=0;c<D.length;c+=1)D[c]&&D[c].m(k,null);ye(k,l[4],!0),a(h,Et),a(h,ue),a(ue,Se),a(ue,bt),a(ue,de),a(de,F),a(F,Te),a(F,yt),a(F,Ie),Z.m(Ie,null),a(F,Ct),a(F,_e),a(de,kt),a(de,he),a(he,pe),a(pe,Le),a(pe,St),a(pe,ae),M(ae,l[7]),a(he,Tt),a(he,ve),a(ve,De),a(ve,It),a(ve,K),a(K,oe);for(let c=0;c<N.length;c+=1)N[c]&&N[c].m(K,null);ye(K,l[10],!0),a(h,Lt),a(h,me),a(me,Ne),a(me,Dt),a(me,ge),a(ge,Ee),a(Ee,Oe),a(Ee,Nt),a(Ee,ie),M(ie,l[8]),a(ge,Ot),a(ge,be),a(be,Pe),a(be,Pt),a(be,ce),M(ce,l[9]),a(h,Vt),a(h,Q),a(Q,fe),a(fe,et),a(Q,wt),B&&B.m(Q,null),a(Q,tt),U&&U.m(Q,null),a(h,At),a(h,Ve),Y=!0,jt||(Yt=[J(z,"change",l[22]),J(A,"change",l[23]),J(k,"change",l[24]),J(_e,"change",l[17]),J(F,"click",l[25]),J(ae,"input",l[26]),J(K,"change",l[27]),J(ie,"input",l[28]),J(ce,"input",l[29]),J(fe,"click",Il(l[21])),J(h,"drop",l[18]),J(h,"dragover",l[19]),J(h,"dragleave",l[20])],jt=!0)},p(r,p){if(Xe.p(r,p),p[0]&32769&&ye(z,r[0]),(!Y||p[0]&1)&&ke!==(ke=r[0]?"Select chapter":"Pick tcode first")&&$(je,ke),p[0]&2){Ue=Ce(r[1]);let c;for(c=0;c<Ue.length;c+=1){const H=dl(r,Ue,c);L[c]?L[c].p(H,p):(L[c]=pl(H),L[c].c(),L[c].m(A,null))}for(;c<L.length;c+=1)L[c].d(1);L.length=Ue.length}if((!Y||p[0]&32771&&Be!==(Be=!r[0]||!r[1].length))&&(A.disabled=Be),p[0]&6&&ye(A,r[2]),r[5]?j?j.p(r,p):(j=vl(r),j.c(),j.m(R,null)):j&&(j.d(1),j=null),(!Y||p[0]&4)&&X!==(X=r[2]?"Select exercise":"Pick chapter first")&&$(Ze,X),p[0]&8){Me=Ce(r[3]);let c;for(c=0;c<Me.length;c+=1){const H=ul(r,Me,c);D[c]?D[c].p(H,p):(D[c]=ml(H),D[c].c(),D[c].m(k,null))}for(;c<D.length;c+=1)D[c].d(1);D.length=Me.length}if((!Y||p[0]&14&&xe!==(xe=!r[2]||!r[3].length))&&(k.disabled=xe),p[0]&24&&ye(k,r[4]),lt===(lt=Zt(r))&&Z?Z.p(r,p):(Z.d(1),Z=lt(r),Z&&(Z.c(),Z.m(Ie,null))),(!Y||p[0]&16384&&$e!==($e=rl("dropzone "+(r[14]?"is-dragging":""))+" svelte-9yylr6"))&&f(F,"class",$e),p[0]&128&&ae.value!==r[7]&&M(ae,r[7]),p[0]&65536){ze=Ce(r[16]);let c;for(c=0;c<ze.length;c+=1){const H=fl(r,ze,c);N[c]?N[c].p(H,p):(N[c]=gl(H),N[c].c(),N[c].m(K,null))}for(;c<N.length;c+=1)N[c].d(1);N.length=ze.length}p[0]&66560&&ye(K,r[10]),p[0]&256&&ie.value!==r[8]&&M(ie,r[8]),p[0]&512&&ce.value!==r[9]&&M(ce,r[9]),(!Y||p[0]&2048)&&We!==(We=r[11]?"Uploading…":"Upload JSON")&&$(et,We),(!Y||p[0]&2048)&&(fe.disabled=r[11]),r[12]?B?B.p(r,p):(B=El(r),B.c(),B.m(Q,tt)):B&&(B.d(1),B=null),r[13]?U?U.p(r,p):(U=bl(r),U.c(),U.m(Q,null)):U&&(U.d(1),U=null)},i(r){Y||(nl(e.$$.fragment,r),nl(s.$$.fragment,r),Y=!0)},o(r){sl(e.$$.fragment,r),sl(s.$$.fragment,r),Y=!1},d(r){r&&(_(t),_(n),_(i)),ll(e,r),ll(s,r),Xe.d(),vt(L,r),j&&j.d(),vt(D,r),Z.d(),vt(N,r),B&&B.d(),U&&U.d(),jt=!1,Tl(Yt)}}}function Ft(l){return(l||"").replace(/\.json$/i,"").trim().toLowerCase().replace(/[^a-z0-9_-]+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")}function Ml(l,e,t){var Qe;const s=Nl();let n=((Qe=s[0])==null?void 0:Qe.tcodeName)??"",i=[],o="",C=[],T="",h="",g="",m=null,ee="",se="",w="",G="",W=!1,we="",te="",z=!1;const Ae=["draft","ready","published","archived"];function R(y){var S,X;const k=((X=(S=y.target)==null?void 0:S.files)==null?void 0:X[0])??null;t(6,m=k),t(7,ee=k?Ft(k.name):"")}function ne(y){var S,X;y.preventDefault(),t(14,z=!1);const k=((X=(S=y.dataTransfer)==null?void 0:S.files)==null?void 0:X[0])??null;t(6,m=k),t(7,ee=k?Ft(k.name):"")}function Ye(y){y.preventDefault(),t(14,z=!0)}function Je(){t(14,z=!1)}async function A(){if(t(13,te=""),t(12,we=""),!m){t(13,te="Pick a .json file.");return}if(!/\.json$/i.test(m.name)){t(13,te="Only .json files allowed.");return}if(!n||!h||!g){t(13,te="tcode, chapter, exercise are required.");return}t(11,W=!0);try{const y=new FormData;y.append("tcode",n.trim()),y.append("chapter",String(parseInt(h,10))),y.append("exercise",g.trim()),y.append("file",m),y.append("filename",Ft(ee||m.name)),se&&y.append("description",se),w&&y.append("tags",w),G&&y.append("status",G);const k=await fetch("/admin/upload_json",{method:"POST",body:y}),S=await k.json();if(!k.ok)throw new Error((S==null?void 0:S.error)||"Upload failed");t(12,we=`Uploaded ✓ (${S.filename})`),t(6,m=null),t(7,ee=""),(document.getElementById("file")||{}).value=""}catch(y){t(13,te=y.message||"Error")}finally{t(11,W=!1)}}function q(){n=pt(this),t(0,n),t(15,s)}function ke(){o=pt(this),t(2,o),t(1,i),t(0,n),t(1,i),t(0,n)}function je(){T=pt(this),t(4,T),t(3,C),t(0,n),t(2,o),t(1,i),t(3,C),t(0,n),t(2,o),t(1,i)}const Be=()=>{var y;return(y=document.getElementById("file"))==null?void 0:y.click()};function qe(){ee=this.value,t(7,ee)}function Ke(){G=pt(this),t(10,G),t(16,Ae)}function le(){se=this.value,t(8,se)}function re(){w=this.value,t(9,w)}return l.$$.update=()=>{l.$$.dirty[0]&1&&t(1,i=n?Ol(n):[]),l.$$.dirty[0]&6&&(i.find(y=>y.filename===o)||t(2,o="")),l.$$.dirty[0]&5&&t(5,h=n&&o?String(Pl(n,o)):""),l.$$.dirty[0]&5&&t(3,C=n&&o?Vl(n,o):[]),l.$$.dirty[0]&24&&(C.find(y=>y.filename===T)||t(4,T="")),l.$$.dirty[0]&16&&(g=T)},[n,i,o,C,T,h,m,ee,se,w,G,W,we,te,z,s,Ae,R,ne,Ye,Je,A,q,ke,je,Be,qe,Ke,le,re]}class Ql extends Cl{constructor(e){super(),kl(this,e,Ml,Ul,Sl,{},null,[-1,-1])}}export{Ql as component};
