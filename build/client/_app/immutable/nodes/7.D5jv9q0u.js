import{S as mt,i as vt,s as kt,d as v,v as bt,D as at,t as yt,a as gt,w as Ct,f as B,h as u,J as H,N as w,x as m,y as wt,m as O,j as b,A as M,k as V,z as St,q as I,o as y,r as Tt,M as Nt,O as Et,P as tt,e as nt,l as x,p as J,n as _t,E as pt,Q as it,F as Z,R as ut}from"../chunks/MRdXX-TE.js";import{e as lt}from"../chunks/ReGSdYAt.js";import"../chunks/IHki7fMi.js";import{p as At}from"../chunks/CDgkHPo6.js";import{N as Ut}from"../chunks/DnkUNHIT.js";function ct(n,e,t){const r=n.slice();return r[28]=e[t],r[29]=e,r[30]=t,r}function dt(n,e,t){const r=n.slice();return r[31]=e[t],r[32]=e,r[33]=t,r}function Ot(n){let e,t,r,l=n[4].toFixed(2)+"",_,p,g,k;function D(o,c){return o[6]?jt:Dt}let T=D(n),f=T(n),A=lt(n[0].deck),h=[];for(let o=0;o<A.length;o+=1)h[o]=ht(ct(n,A,o));return{c(){f.c(),e=I(),t=y("div"),r=J("Current Time: "),_=J(l),p=J("s"),g=I();for(let o=0;o<h.length;o+=1)h[o].c();k=it(),this.h()},l(o){f.l(o),e=O(o),t=b(o,"DIV",{class:!0});var c=V(t);r=x(c,"Current Time: "),_=x(c,l),p=x(c,"s"),c.forEach(v),g=O(o);for(let d=0;d<h.length;d+=1)h[d].l(o);k=it(),this.h()},h(){m(t,"class","time-display svelte-lskhmy")},m(o,c){f.m(o,c),B(o,e,c),B(o,t,c),u(t,r),u(t,_),u(t,p),B(o,g,c);for(let d=0;d<h.length;d+=1)h[d]&&h[d].m(o,c);B(o,k,c)},p(o,c){if(T===(T=D(o))&&f?f.p(o,c):(f.d(1),f=T(o),f&&(f.c(),f.m(e.parentNode,e))),c[0]&16&&l!==(l=o[4].toFixed(2)+"")&&nt(_,l),c[0]&3969){A=lt(o[0].deck);let d;for(d=0;d<A.length;d+=1){const F=ct(o,A,d);h[d]?h[d].p(F,c):(h[d]=ht(F),h[d].c(),h[d].m(k.parentNode,k))}for(;d<h.length;d+=1)h[d].d(1);h.length=A.length}},d(o){o&&(v(e),v(t),v(g),v(k)),f.d(o),pt(h,o)}}}function It(n){let e,t="Loading deck…";return{c(){e=y("p"),e.textContent=t,this.h()},l(r){e=b(r,"P",{class:!0,"data-svelte-h":!0}),M(e)!=="svelte-88q0iq"&&(e.textContent=t),this.h()},h(){m(e,"class","centered svelte-lskhmy")},m(r,l){B(r,e,l)},p:_t,d(r){r&&v(e)}}}function Pt(n){let e,t,r;return{c(){e=y("p"),t=J("Error: "),r=J(n[2]),this.h()},l(l){e=b(l,"P",{class:!0});var _=V(e);t=x(_,"Error: "),r=x(_,n[2]),_.forEach(v),this.h()},h(){m(e,"class","error svelte-lskhmy")},m(l,_){B(l,e,_),u(e,t),u(e,r)},p(l,_){_[0]&4&&nt(r,l[2])},d(l){l&&v(e)}}}function Dt(n){let e,t="💡 Sound not found";return{c(){e=y("h1"),e.textContent=t,this.h()},l(r){e=b(r,"H1",{style:!0,"data-svelte-h":!0}),M(e)!=="svelte-km9r49"&&(e.textContent=t),this.h()},h(){w(e,"width","100%"),w(e,"border","2px solid #facc15"),w(e,"border-radius","0.375rem"),w(e,"text-align","center"),w(e,"font-size","1.2rem"),w(e,"padding","6px"),w(e,"margin","2px"),w(e,"background-color","#0f4502")},m(r,l){B(r,e,l)},p:_t,d(r){r&&v(e)}}}function jt(n){let e,t,r;return{c(){e=y("div"),t=y("audio"),this.h()},l(l){e=b(l,"DIV",{class:!0});var _=V(e);t=b(_,"AUDIO",{src:!0,class:!0}),V(t).forEach(v),_.forEach(v),this.h()},h(){ut(t.src,r=n[5])||m(t,"src",r),t.controls=!0,m(t,"class","w-full"),m(e,"class","audio-panel svelte-lskhmy")},m(l,_){B(l,e,_),u(e,t),n[15](t)},p(l,_){_[0]&32&&!ut(t.src,r=l[5])&&m(t,"src",r)},d(l){l&&v(e),n[15](null)}}}function ft(n){let e,t,r,l="showAt:",_,p,g,k,D="0",T,f,A="Now",h,o,c=(n[31].name||n[31].type)+"",d,F,U,E,P,S,a="Delete",C,z;function X(){n[17].call(p,n[32],n[33])}function K(){return n[18](n[31])}function W(){return n[19](n[31])}function Y(){n[20].call(E,n[32],n[33])}function et(){return n[21](n[30],n[33])}return{c(){e=y("div"),t=y("div"),r=y("span"),r.textContent=l,_=I(),p=y("input"),g=I(),k=y("button"),k.textContent=D,T=I(),f=y("button"),f.textContent=A,h=I(),o=y("span"),d=J(c),F=J(":"),U=I(),E=y("input"),P=I(),S=y("button"),S.textContent=a,this.h()},l(L){e=b(L,"DIV",{class:!0});var s=V(e);t=b(s,"DIV",{style:!0});var i=V(t);r=b(i,"SPAN",{"data-svelte-h":!0}),M(r)!=="svelte-19kgj58"&&(r.textContent=l),_=O(i),p=b(i,"INPUT",{type:!0,step:!0,class:!0}),g=O(i),k=b(i,"BUTTON",{class:!0,"data-svelte-h":!0}),M(k)!=="svelte-u1blfk"&&(k.textContent=D),T=O(i),f=b(i,"BUTTON",{class:!0,"data-svelte-h":!0}),M(f)!=="svelte-i54ylz"&&(f.textContent=A),h=O(i),o=b(i,"SPAN",{class:!0});var R=V(o);d=x(R,c),F=x(R,":"),R.forEach(v),U=O(i),E=b(i,"INPUT",{type:!0,placeholder:!0,class:!0}),P=O(i),S=b(i,"BUTTON",{class:!0,"data-svelte-h":!0}),M(S)!=="svelte-1ex4cm4"&&(S.textContent=a),i.forEach(v),s.forEach(v),this.h()},h(){m(p,"type","number"),m(p,"step","0.0"),m(p,"class","svelte-lskhmy"),m(k,"class","set-show-zero svelte-lskhmy"),m(f,"class","set-show svelte-lskhmy"),m(o,"class","bg-red-950 "),m(E,"type","text"),m(E,"placeholder","Edit content"),m(E,"class","svelte-lskhmy"),m(S,"class","delete-item svelte-lskhmy"),w(t,"display","flex"),w(t,"align-items","center"),w(t,"gap","0.5rem"),m(e,"class","item svelte-lskhmy")},m(L,s){B(L,e,s),u(e,t),u(t,r),u(t,_),u(t,p),Z(p,n[31].showAt),u(t,g),u(t,k),u(t,T),u(t,f),u(t,h),u(t,o),u(o,d),u(o,F),u(t,U),u(t,E),Z(E,n[31].content),u(t,P),u(t,S),C||(z=[H(p,"input",X),H(k,"click",K),H(f,"click",W),H(E,"input",Y),H(S,"click",et)],C=!0)},p(L,s){n=L,s[0]&1&&tt(p.value)!==n[31].showAt&&Z(p,n[31].showAt),s[0]&1&&c!==(c=(n[31].name||n[31].type)+"")&&nt(d,c),s[0]&1&&E.value!==n[31].content&&Z(E,n[31].content)},d(L){L&&v(e),C=!1,at(z)}}}function ht(n){let e,t,r,l,_=n[30]+1+"",p,g,k=n[28].type+"",D,T,f,A="Set Start = Now",h,o,c,d,F,U,E,P,S,a,C,z,X="Set End = Now",K,W,Y;function et(){return n[16](n[30])}let L=lt(n[28].data),s=[];for(let j=0;j<L.length;j+=1)s[j]=ft(dt(n,L,j));function i(){n[22].call(U,n[29],n[30])}function R(){n[23].call(a,n[29],n[30])}function G(){return n[24](n[30])}return{c(){e=y("div"),t=y("div"),r=y("strong"),l=J("Slide "),p=J(_),g=J(" — "),D=J(k),T=I(),f=y("button"),f.textContent=A,h=I();for(let j=0;j<s.length;j+=1)s[j].c();o=I(),c=y("div"),d=y("label"),F=J(`Start:
          `),U=y("input"),E=I(),P=y("label"),S=J(`End:
          `),a=y("input"),C=I(),z=y("button"),z.textContent=X,K=I(),this.h()},l(j){e=b(j,"DIV",{class:!0});var q=V(e);t=b(q,"DIV",{class:!0});var N=V(t);r=b(N,"STRONG",{});var Q=V(r);l=x(Q,"Slide "),p=x(Q,_),g=x(Q," — "),D=x(Q,k),Q.forEach(v),T=O(N),f=b(N,"BUTTON",{class:!0,"data-svelte-h":!0}),M(f)!=="svelte-1worsv"&&(f.textContent=A),N.forEach(v),h=O(q);for(let ot=0;ot<s.length;ot+=1)s[ot].l(q);o=O(q),c=b(q,"DIV",{style:!0});var $=V(c);d=b($,"LABEL",{});var st=V(d);F=x(st,`Start:
          `),U=b(st,"INPUT",{type:!0,step:!0,class:!0}),st.forEach(v),E=O($),P=b($,"LABEL",{style:!0});var rt=V(P);S=x(rt,`End:
          `),a=b(rt,"INPUT",{type:!0,step:!0,class:!0}),rt.forEach(v),C=O($),z=b($,"BUTTON",{class:!0,"data-svelte-h":!0}),M(z)!=="svelte-1s9qi15"&&(z.textContent=X),$.forEach(v),K=O(q),q.forEach(v),this.h()},h(){m(f,"class","set-start svelte-lskhmy"),f.disabled=n[30]===0,m(t,"class","slide-header svelte-lskhmy"),m(U,"type","number"),m(U,"step","0.01"),m(U,"class","svelte-lskhmy"),m(a,"type","number"),m(a,"step","0.01"),m(a,"class","svelte-lskhmy"),w(P,"margin-left","1rem"),m(z,"class","set-end svelte-lskhmy"),w(c,"display","flex"),w(c,"align-items","center"),w(c,"margin-top","0.5rem"),m(e,"class","slide svelte-lskhmy")},m(j,q){B(j,e,q),u(e,t),u(t,r),u(r,l),u(r,p),u(r,g),u(r,D),u(t,T),u(t,f),u(e,h);for(let N=0;N<s.length;N+=1)s[N]&&s[N].m(e,null);u(e,o),u(e,c),u(c,d),u(d,F),u(d,U),Z(U,n[28].start),u(c,E),u(c,P),u(P,S),u(P,a),Z(a,n[28].end),u(c,C),u(c,z),u(e,K),W||(Y=[H(f,"click",et),H(U,"input",i),H(a,"input",R),H(z,"click",G)],W=!0)},p(j,q){if(n=j,q[0]&1&&k!==(k=n[28].type+"")&&nt(D,k),q[0]&3585){L=lt(n[28].data);let N;for(N=0;N<L.length;N+=1){const Q=dt(n,L,N);s[N]?s[N].p(Q,q):(s[N]=ft(Q),s[N].c(),s[N].m(e,o))}for(;N<s.length;N+=1)s[N].d(1);s.length=L.length}q[0]&1&&tt(U.value)!==n[28].start&&Z(U,n[28].start),q[0]&1&&tt(a.value)!==n[28].end&&Z(a,n[28].end)},d(j){j&&v(e),pt(s,j),W=!1,at(Y)}}}function Bt(n){let e,t,r,l="💡 Timing Page",_,p,g,k="Save",D,T,f="Save and Download",A,h,o,c="➕ Add Slide",d,F,U;e=new Ut({});function E(a,C){return a[2]?Pt:a[1]?Ot:It}let P=E(n),S=P(n);return{c(){St(e.$$.fragment),t=I(),r=y("h1"),r.textContent=l,_=I(),p=y("div"),g=y("button"),g.textContent=k,D=I(),T=y("button"),T.textContent=f,A=I(),S.c(),h=I(),o=y("button"),o.textContent=c,this.h()},l(a){wt(e.$$.fragment,a),t=O(a),r=b(a,"H1",{style:!0,"data-svelte-h":!0}),M(r)!=="svelte-b6baqi"&&(r.textContent=l),_=O(a),p=b(a,"DIV",{class:!0,style:!0});var C=V(p);g=b(C,"BUTTON",{class:!0,"data-svelte-h":!0}),M(g)!=="svelte-mcs0te"&&(g.textContent=k),D=O(C),T=b(C,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),M(T)!=="svelte-cj91f7"&&(T.textContent=f),C.forEach(v),A=O(a),S.l(a),h=O(a),o=b(a,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),M(o)!=="svelte-1cst4ef"&&(o.textContent=c),this.h()},h(){w(r,"width","100%"),w(r,"border","2px solid #facc15"),w(r,"border-radius","0.375rem"),w(r,"text-align","center"),w(r,"font-size","1.2rem"),w(r,"padding","6px"),w(r,"margin","2px"),w(r,"background-color","#0f4502"),m(g,"class","btn svelte-lskhmy"),m(T,"class","btn svelte-lskhmy"),w(T,"margin-left","0.5rem"),m(p,"class","timing-actions"),w(p,"margin","1rem 0"),m(o,"class","btn svelte-lskhmy"),w(o,"margin-left","0.5rem"),w(o,"background-color","#2563eb")},m(a,C){Ct(e,a,C),B(a,t,C),B(a,r,C),B(a,_,C),B(a,p,C),u(p,g),u(p,D),u(p,T),B(a,A,C),S.m(a,C),B(a,h,C),B(a,o,C),d=!0,F||(U=[H(g,"click",n[12]),H(T,"click",n[13]),H(o,"click",n[14])],F=!0)},p(a,C){P===(P=E(a))&&S?S.p(a,C):(S.d(1),S=P(a),S&&(S.c(),S.m(h.parentNode,h)))},i(a){d||(gt(e.$$.fragment,a),d=!0)},o(a){yt(e.$$.fragment,a),d=!1},d(a){a&&(v(t),v(r),v(_),v(p),v(A),v(h),v(o)),bt(e,a),S.d(a),F=!1,at(U)}}}function Ft(n,e,t){let r;Tt(n,At,s=>t(25,r=s));let l=null,_=!1,p="",g=null,k=0,D="/sounds/default.opus";const T=()=>{g&&t(4,k=g.currentTime),requestAnimationFrame(T)};function f(s){if(!(l!=null&&l.deck))return;const i=parseFloat(k.toFixed(2));t(0,l.deck[s].end=i,l),l.deck[s+1]&&t(0,l.deck[s+1].start=i,l),t(0,l={...l})}function A(s){if(!(l!=null&&l.deck)||s===0)return;const i=parseFloat(k.toFixed(2));t(0,l.deck[s-1].end=i,l),t(0,l.deck[s].start=i,l),t(0,l={...l})}function h(s){s.showAt=parseFloat(k.toFixed(1)),t(0,l={...l})}function o(s){s.showAt=0,t(0,l={...l})}function c(s,i){l!=null&&l.deck&&(l.deck[s].data.splice(i,1),t(0,l={...l}))}async function d(){const s=r.url.searchParams.get("filename")??"",i=await fetch(`/admin/timings?filename=${encodeURIComponent(s)}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!i.ok){let R;try{const G=await i.json();R=G.error??JSON.stringify(G)}catch{R=await i.text()}return alert(`❌ Save failed: ${R}`),!1}return alert("✅ Save successful"),!0}async function F(){await d()&&U()}function U(){const s=r.url.searchParams.get("filename")??"deck",i=new Blob([JSON.stringify(l,null,2)],{type:"application/json"}),R=URL.createObjectURL(i),G=document.createElement("a");G.href=R,G.download=`${s}.json`,document.body.appendChild(G),G.click(),document.body.removeChild(G),URL.revokeObjectURL(R)}let E=!1;Nt(async()=>{T();const s=r.url.searchParams.get("filename");if(!s){t(2,p="No filename provided");return}try{(await fetch(`/sounds/${s}.opus`,{method:"HEAD"})).ok&&(t(5,D=`/sounds/${s}.opus`),t(6,E=!0))}catch{}try{const i=await fetch(`/admin/timings?filename=${encodeURIComponent(s)}`);if(!i.ok){const R=await i.json();throw new Error(R.error||i.statusText)}t(0,l=await i.json()),console.log("deck",l),t(1,_=!0)}catch(i){t(2,p=i.message)}});function P(){if(!(l!=null&&l.deck))return;const s={type:"titleSlide",start:0,end:0,data:[{type:"text",content:"New Slide Content",showAt:0}]};l.deck.push(s),t(0,l={...l})}function S(s){Et[s?"unshift":"push"](()=>{g=s,t(3,g)})}const a=s=>A(s);function C(s,i){s[i].showAt=tt(this.value),t(0,l)}const z=s=>o(s),X=s=>h(s);function K(s,i){s[i].content=this.value,t(0,l)}const W=(s,i)=>c(s,i);function Y(s,i){s[i].start=tt(this.value),t(0,l)}function et(s,i){s[i].end=tt(this.value),t(0,l)}return[l,_,p,g,k,D,E,f,A,h,o,c,d,F,P,S,a,C,z,X,K,W,Y,et,s=>f(s)]}class xt extends mt{constructor(e){super(),vt(this,e,Ft,Bt,kt,{},null,[-1,-1])}}export{xt as component};
