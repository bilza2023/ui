import{S as Wt,i as Zt,s as $t,n as Mt,d as _,E as Qt,D as te,F as X,I as qt,P as Xt,f as ot,h as e,J as _t,X as ee,x as r,K as le,B as se,m as C,j as d,k as y,A as U,q as T,o as h,e as et,l as M,p as B,L as ae,Y as jt}from"../chunks/MRdXX-TE.js";import{e as wt}from"../chunks/ReGSdYAt.js";import"../chunks/IHki7fMi.js";import{i as re,a as ne,p as oe,b as ie}from"../chunks/OBsGlrAT.js";function ue(l){const t=JSON.parse(l);return t.data&&(t.data=oe(t.data,ie.decoders)),t}function Ut(l){return HTMLElement.prototype.cloneNode.call(l)}function ce(l,t=()=>{}){const s=async({action:u,result:c,reset:o=!0,invalidateAll:a=!0})=>{c.type==="success"&&(o&&HTMLFormElement.prototype.reset.call(l),a&&await re()),(location.origin+location.pathname===u.origin+u.pathname||c.type==="redirect"||c.type==="error")&&await ne(c)};async function i(u){var O,w,S,Z,g;if(((O=u.submitter)!=null&&O.hasAttribute("formmethod")?u.submitter.formMethod:Ut(l).method)!=="post")return;u.preventDefault();const o=new URL((w=u.submitter)!=null&&w.hasAttribute("formaction")?u.submitter.formAction:Ut(l).action),a=(S=u.submitter)!=null&&S.hasAttribute("formenctype")?u.submitter.formEnctype:Ut(l).enctype,n=new FormData(l),v=(Z=u.submitter)==null?void 0:Z.getAttribute("name");v&&n.append(v,((g=u.submitter)==null?void 0:g.getAttribute("value"))??"");const f=new AbortController;let k=!1;const z=await t({action:o,cancel:()=>k=!0,controller:f,formData:n,formElement:l,submitter:u.submitter})??s;if(k)return;let x;try{const b=new Headers({accept:"application/json","x-sveltekit-action":"true"});a!=="multipart/form-data"&&b.set("Content-Type",/^(:?application\/x-www-form-urlencoded|text\/plain)$/.test(a)?a:"application/x-www-form-urlencoded");const lt=a==="multipart/form-data"?n:new URLSearchParams(n),$=await fetch(o,{method:"POST",headers:b,cache:"no-store",body:lt,signal:f.signal});x=ue(await $.text()),x.type==="error"&&(x.status=$.status)}catch(b){if((b==null?void 0:b.name)==="AbortError")return;x={type:"error",error:b}}await z({action:o,formData:n,formElement:l,update:b=>s({action:o,result:x,reset:b==null?void 0:b.reset,invalidateAll:b==null?void 0:b.invalidateAll}),result:x})}return HTMLFormElement.prototype.addEventListener.call(l,"submit",i),{destroy(){HTMLFormElement.prototype.removeEventListener.call(l,"submit",i)}}}function Gt(l,t,s){const i=l.slice();return i[14]=t[s],i}function zt(l,t,s){const i=l.slice();return i[17]=t[s],i}function Jt(l){let t,s=l[17].tcodeName+"",i,u,c=l[17].description+"",o,a;return{c(){t=h("option"),i=B(s),u=B(" — "),o=B(c),this.h()},l(n){t=d(n,"OPTION",{});var v=y(t);i=M(v,s),u=M(v," — "),o=M(v,c),v.forEach(_),this.h()},h(){t.__value=a=l[17].tcodeName,X(t,t.__value)},m(n,v){ot(n,t,v),e(t,i),e(t,u),e(t,o)},p(n,v){v&1&&s!==(s=n[17].tcodeName+"")&&et(i,s),v&1&&c!==(c=n[17].description+"")&&et(o,c),v&1&&a!==(a=n[17].tcodeName)&&(t.__value=a,X(t,t.__value))},d(n){n&&_(t)}}}function Yt(l){let t,s,i,u=l[6].email+"",c;return{c(){t=h("p"),s=B("Selected user: "),i=h("strong"),c=B(u),this.h()},l(o){t=d(o,"P",{class:!0});var a=y(t);s=M(a,"Selected user: "),i=d(a,"STRONG",{});var n=y(i);c=M(n,u),n.forEach(_),a.forEach(_),this.h()},h(){r(t,"class","hint svelte-ug6hxk")},m(o,a){ot(o,t,a),e(t,s),e(t,i),e(i,c)},p(o,a){a&64&&u!==(u=o[6].email+"")&&et(c,u)},d(o){o&&_(t)}}}function de(l){let t,s,i='<tr><th class="svelte-ug6hxk">Tcode</th> <th class="svelte-ug6hxk">Start</th> <th class="svelte-ug6hxk">Duration</th> <th class="svelte-ug6hxk">Expires</th> <th class="svelte-ug6hxk">Status</th> <th class="svelte-ug6hxk">Remaining</th> <th class="svelte-ug6hxk">Quick</th></tr>',u,c,o=wt(l[5]),a=[];for(let n=0;n<o.length;n+=1)a[n]=Kt(Gt(l,o,n));return{c(){t=h("table"),s=h("thead"),s.innerHTML=i,u=T(),c=h("tbody");for(let n=0;n<a.length;n+=1)a[n].c();this.h()},l(n){t=d(n,"TABLE",{class:!0});var v=y(t);s=d(v,"THEAD",{"data-svelte-h":!0}),U(s)!=="svelte-1xfvb8m"&&(s.innerHTML=i),u=C(v),c=d(v,"TBODY",{});var f=y(c);for(let k=0;k<a.length;k+=1)a[k].l(f);f.forEach(_),v.forEach(_),this.h()},h(){r(t,"class","subs svelte-ug6hxk")},m(n,v){ot(n,t,v),e(t,s),e(t,u),e(t,c);for(let f=0;f<a.length;f+=1)a[f]&&a[f].m(c,null)},p(n,v){if(v&160){o=wt(n[5]);let f;for(f=0;f<o.length;f+=1){const k=Gt(n,o,f);a[f]?a[f].p(k,v):(a[f]=Kt(k),a[f].c(),a[f].m(c,null))}for(;f<a.length;f+=1)a[f].d(1);a.length=o.length}},d(n){n&&_(t),Qt(a,n)}}}function he(l){let t,s,i,u=l[6].email+"",c,o;return{c(){t=h("p"),s=B("No subscriptions yet for "),i=h("strong"),c=B(u),o=B("."),this.h()},l(a){t=d(a,"P",{class:!0});var n=y(t);s=M(n,"No subscriptions yet for "),i=d(n,"STRONG",{});var v=y(i);c=M(v,u),v.forEach(_),o=M(n,"."),n.forEach(_),this.h()},h(){r(t,"class","muted svelte-ug6hxk")},m(a,n){ot(a,t,n),e(t,s),e(t,i),e(i,c),e(t,o)},p(a,n){n&64&&u!==(u=a[6].email+"")&&et(c,u)},d(a){a&&_(t)}}}function fe(l){let t,s="Look up a user to view their subscriptions.";return{c(){t=h("p"),t.textContent=s,this.h()},l(i){t=d(i,"P",{class:!0,"data-svelte-h":!0}),U(t)!=="svelte-k5u1c"&&(t.textContent=s),this.h()},h(){r(t,"class","muted svelte-ug6hxk")},m(i,u){ot(i,t,u)},p:Mt,d(i){i&&_(t)}}}function Kt(l){var gt,ft;let t,s,i=l[14].tcode+"",u,c,o,a=((gt=l[14].start_date)==null?void 0:gt.slice(0,10))+"",n,v,f,k=l[14].duration+"",W,z,x,O,w=((ft=l[14].expiresAt)==null?void 0:ft.slice(0,10))+"",S,Z,g,b=l[14].status+"",lt,$,P,R=l[14].status==="active"?`${l[14].remainingDays}d`:"-",it,ut,D,q,J="Renew…",G,ct,dt,L;function j(){return l[13](l[14])}return{c(){t=h("tr"),s=h("td"),u=B(i),c=T(),o=h("td"),n=B(a),v=T(),f=h("td"),W=B(k),z=B("d"),x=T(),O=h("td"),S=B(w),Z=T(),g=h("td"),lt=B(b),$=T(),P=h("td"),it=B(R),ut=T(),D=h("td"),q=h("button"),q.textContent=J,G=T(),this.h()},l(I){t=d(I,"TR",{class:!0});var m=y(t);s=d(m,"TD",{class:!0});var nt=y(s);u=M(nt,i),nt.forEach(_),c=C(m),o=d(m,"TD",{class:!0});var st=y(o);n=M(st,a),st.forEach(_),v=C(m),f=d(m,"TD",{class:!0});var A=y(f);W=M(A,k),z=M(A,"d"),A.forEach(_),x=C(m),O=d(m,"TD",{class:!0});var vt=y(O);S=M(vt,w),vt.forEach(_),Z=C(m),g=d(m,"TD",{class:!0});var Y=y(g);lt=M(Y,b),Y.forEach(_),$=C(m),P=d(m,"TD",{class:!0});var K=y(P);it=M(K,R),K.forEach(_),ut=C(m),D=d(m,"TD",{class:!0});var bt=y(D);q=d(bt,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),U(q)!=="svelte-pcbgtz"&&(q.textContent=J),bt.forEach(_),G=C(m),m.forEach(_),this.h()},h(){r(s,"class","svelte-ug6hxk"),r(o,"class","svelte-ug6hxk"),r(f,"class","svelte-ug6hxk"),r(O,"class","svelte-ug6hxk"),r(g,"class","status svelte-ug6hxk"),r(P,"class","svelte-ug6hxk"),r(q,"type","button"),r(q,"class","svelte-ug6hxk"),r(D,"class","svelte-ug6hxk"),r(t,"class",ct=jt(l[14].status)+" svelte-ug6hxk")},m(I,m){ot(I,t,m),e(t,s),e(s,u),e(t,c),e(t,o),e(o,n),e(t,v),e(t,f),e(f,W),e(f,z),e(t,x),e(t,O),e(O,S),e(t,Z),e(t,g),e(g,lt),e(t,$),e(t,P),e(P,it),e(t,ut),e(t,D),e(D,q),e(t,G),dt||(L=_t(q,"click",j),dt=!0)},p(I,m){var nt,st;l=I,m&32&&i!==(i=l[14].tcode+"")&&et(u,i),m&32&&a!==(a=((nt=l[14].start_date)==null?void 0:nt.slice(0,10))+"")&&et(n,a),m&32&&k!==(k=l[14].duration+"")&&et(W,k),m&32&&w!==(w=((st=l[14].expiresAt)==null?void 0:st.slice(0,10))+"")&&et(S,w),m&32&&b!==(b=l[14].status+"")&&et(lt,b),m&32&&R!==(R=l[14].status==="active"?`${l[14].remainingDays}d`:"-")&&et(it,R),m&32&&ct!==(ct=jt(l[14].status)+" svelte-ug6hxk")&&r(t,"class",ct)},d(I){I&&_(t),dt=!1,L()}}}function ve(l){let t,s,i,u="Subscriptions (Admin)",c,o,a,n="Find User",v,f,k,W="Email",z,x,O,w,S="Load",Z,g,b,lt="Grant Subscription",$,P,R,it="Email",ut,D,q,J,G,ct="Tcode",dt,L,j,gt="Select tcode…",ft,I,m,nt="Duration (days)",st,A,vt,Y,K,bt="Start Date (optional)",Lt,tt,At,ht,Bt='<button type="submit" formaction="?/grant" class="svelte-ug6hxk">Grant</button>',St,Nt,at,pt,Rt="User Subscriptions",It,Ht,Ft,mt=wt(l[0].tcodes),N=[];for(let p=0;p<mt.length;p+=1)N[p]=Jt(zt(l,mt,p));let H=l[6]&&Yt(l);function Vt(p,F){return p[6]?p[5].length?de:he:fe}let kt=Vt(l),Q=kt(l);return{c(){t=T(),s=h("div"),i=h("h1"),i.textContent=u,c=T(),o=h("form"),a=h("h2"),a.textContent=n,v=T(),f=h("div"),k=h("label"),k.textContent=W,z=T(),x=h("input"),O=T(),w=h("button"),w.textContent=S,Z=T(),g=h("form"),b=h("h2"),b.textContent=lt,$=T(),P=h("div"),R=h("label"),R.textContent=it,ut=T(),D=h("input"),q=T(),J=h("div"),G=h("label"),G.textContent=ct,dt=T(),L=h("select"),j=h("option"),j.textContent=gt;for(let p=0;p<N.length;p+=1)N[p].c();ft=T(),I=h("div"),m=h("label"),m.textContent=nt,st=T(),A=h("input"),vt=T(),Y=h("div"),K=h("label"),K.textContent=bt,Lt=T(),tt=h("input"),At=T(),ht=h("div"),ht.innerHTML=Bt,St=T(),H&&H.c(),Nt=T(),at=h("div"),pt=h("h2"),pt.textContent=Rt,It=T(),Q.c(),this.h()},l(p){se("svelte-1o8ndr6",document.head).forEach(_),t=C(p),s=d(p,"DIV",{class:!0});var E=y(s);i=d(E,"H1",{class:!0,"data-svelte-h":!0}),U(i)!=="svelte-p1n89a"&&(i.textContent=u),c=C(E),o=d(E,"FORM",{class:!0,method:!0});var rt=y(o);a=d(rt,"H2",{"data-svelte-h":!0}),U(a)!=="svelte-1jzegy0"&&(a.textContent=n),v=C(rt),f=d(rt,"DIV",{class:!0});var xt=y(f);k=d(xt,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),U(k)!=="svelte-1p9d3fm"&&(k.textContent=W),z=C(xt),x=d(xt,"INPUT",{id:!0,name:!0,type:!0,placeholder:!0,class:!0}),xt.forEach(_),O=C(rt),w=d(rt,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),U(w)!=="svelte-1o4yjun"&&(w.textContent=S),rt.forEach(_),Z=C(E),g=d(E,"FORM",{class:!0,method:!0});var V=y(g);b=d(V,"H2",{"data-svelte-h":!0}),U(b)!=="svelte-fpr8r9"&&(b.textContent=lt),$=C(V),P=d(V,"DIV",{class:!0});var Et=y(P);R=d(Et,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),U(R)!=="svelte-fg5qb"&&(R.textContent=it),ut=C(Et),D=d(Et,"INPUT",{id:!0,name:!0,type:!0,placeholder:!0,class:!0}),Et.forEach(_),q=C(V),J=d(V,"DIV",{class:!0});var Ct=y(J);G=d(Ct,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),U(G)!=="svelte-6p13rk"&&(G.textContent=ct),dt=C(Ct),L=d(Ct,"SELECT",{id:!0,name:!0,class:!0});var Ot=y(L);j=d(Ot,"OPTION",{"data-svelte-h":!0}),U(j)!=="svelte-11x0drw"&&(j.textContent=gt);for(let Pt=0;Pt<N.length;Pt+=1)N[Pt].l(Ot);Ot.forEach(_),Ct.forEach(_),ft=C(V),I=d(V,"DIV",{class:!0});var Tt=y(I);m=d(Tt,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),U(m)!=="svelte-1e9580w"&&(m.textContent=nt),st=C(Tt),A=d(Tt,"INPUT",{id:!0,name:!0,type:!0,min:!0,step:!0,class:!0}),Tt.forEach(_),vt=C(V),Y=d(V,"DIV",{class:!0});var yt=y(Y);K=d(yt,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),U(K)!=="svelte-zj7jm1"&&(K.textContent=bt),Lt=C(yt),tt=d(yt,"INPUT",{id:!0,name:!0,type:!0,class:!0}),yt.forEach(_),At=C(V),ht=d(V,"DIV",{class:!0,"data-svelte-h":!0}),U(ht)!=="svelte-1df8u0c"&&(ht.innerHTML=Bt),St=C(V),H&&H.l(V),V.forEach(_),Nt=C(E),at=d(E,"DIV",{class:!0});var Dt=y(at);pt=d(Dt,"H2",{"data-svelte-h":!0}),U(pt)!=="svelte-1mkkoa3"&&(pt.textContent=Rt),It=C(Dt),Q.l(Dt),Dt.forEach(_),E.forEach(_),this.h()},h(){document.title="Admin • Subscriptions",r(i,"class","svelte-ug6hxk"),r(k,"for","email"),r(k,"class","svelte-ug6hxk"),r(x,"id","email"),r(x,"name","email"),r(x,"type","email"),r(x,"placeholder","user@example.com"),x.required=!0,r(x,"class","svelte-ug6hxk"),r(f,"class","row svelte-ug6hxk"),r(w,"type","submit"),r(w,"class","svelte-ug6hxk"),r(o,"class","card svelte-ug6hxk"),r(o,"method","GET"),r(R,"for","grant-email"),r(R,"class","svelte-ug6hxk"),r(D,"id","grant-email"),r(D,"name","email"),r(D,"type","email"),r(D,"placeholder","user@example.com"),D.required=!0,r(D,"class","svelte-ug6hxk"),r(P,"class","row svelte-ug6hxk"),r(G,"for","tcode"),r(G,"class","svelte-ug6hxk"),j.__value="",X(j,j.__value),j.disabled=!0,j.selected=!0,r(L,"id","tcode"),r(L,"name","tcode"),L.required=!0,r(L,"class","svelte-ug6hxk"),l[2]===void 0&&le(()=>l[10].call(L)),r(J,"class","row svelte-ug6hxk"),r(m,"for","duration"),r(m,"class","svelte-ug6hxk"),r(A,"id","duration"),r(A,"name","duration"),r(A,"type","number"),r(A,"min","1"),r(A,"step","1"),A.required=!0,r(A,"class","svelte-ug6hxk"),r(I,"class","row svelte-ug6hxk"),r(K,"for","startDate"),r(K,"class","svelte-ug6hxk"),r(tt,"id","startDate"),r(tt,"name","startDate"),r(tt,"type","date"),r(tt,"class","svelte-ug6hxk"),r(Y,"class","row svelte-ug6hxk"),r(ht,"class","row svelte-ug6hxk"),r(g,"class","card svelte-ug6hxk"),r(g,"method","POST"),r(at,"class","card svelte-ug6hxk"),r(s,"class","page svelte-ug6hxk")},m(p,F){ot(p,t,F),ot(p,s,F),e(s,i),e(s,c),e(s,o),e(o,a),e(o,v),e(o,f),e(f,k),e(f,z),e(f,x),X(x,l[1]),e(o,O),e(o,w),e(s,Z),e(s,g),e(g,b),e(g,$),e(g,P),e(P,R),e(P,ut),e(P,D),X(D,l[1]),e(g,q),e(g,J),e(J,G),e(J,dt),e(J,L),e(L,j);for(let E=0;E<N.length;E+=1)N[E]&&N[E].m(L,null);qt(L,l[2],!0),e(g,ft),e(g,I),e(I,m),e(I,st),e(I,A),X(A,l[3]),e(g,vt),e(g,Y),e(Y,K),e(Y,Lt),e(Y,tt),X(tt,l[4]),e(g,At),e(g,ht),e(g,St),H&&H.m(g,null),e(s,Nt),e(s,at),e(at,pt),e(at,It),Q.m(at,null),Ht||(Ft=[_t(x,"input",l[8]),_t(D,"input",l[9]),_t(L,"change",l[10]),_t(A,"input",l[11]),_t(tt,"input",l[12]),ee(ce.call(null,g))],Ht=!0)},p(p,[F]){if(F&2&&x.value!==p[1]&&X(x,p[1]),F&2&&D.value!==p[1]&&X(D,p[1]),F&1){mt=wt(p[0].tcodes);let E;for(E=0;E<mt.length;E+=1){const rt=zt(p,mt,E);N[E]?N[E].p(rt,F):(N[E]=Jt(rt),N[E].c(),N[E].m(L,null))}for(;E<N.length;E+=1)N[E].d(1);N.length=mt.length}F&5&&qt(L,p[2]),F&8&&Xt(A.value)!==p[3]&&X(A,p[3]),F&16&&X(tt,p[4]),p[6]?H?H.p(p,F):(H=Yt(p),H.c(),H.m(g,null)):H&&(H.d(1),H=null),kt===(kt=Vt(p))&&Q?Q.p(p,F):(Q.d(1),Q=kt(p),Q&&(Q.c(),Q.m(at,null)))},i:Mt,o:Mt,d(p){p&&(_(t),_(s)),Qt(N,p),H&&H.d(),Q.d(),Ht=!1,te(Ft)}}}function pe(l,t,s){let i,u,{data:c}=t;console.log("data",c);let o=c.selectedEmail??"",a="",n=30,v="";function f(S){s(2,a=S.tcode),s(3,n=30),s(4,v="")}function k(){o=this.value,s(1,o)}function W(){o=this.value,s(1,o)}function z(){a=ae(this),s(2,a),s(0,c)}function x(){n=Xt(this.value),s(3,n)}function O(){v=this.value,s(4,v)}const w=S=>f(S);return l.$$set=S=>{"data"in S&&s(0,c=S.data)},l.$$.update=()=>{l.$$.dirty&1&&s(6,i=c.selectedUser),l.$$.dirty&1&&s(5,u=c.subscriptions??[])},[c,o,a,n,v,u,i,f,k,W,z,x,O,w]}class ke extends Wt{constructor(t){super(),Zt(this,t,pe,ve,$t,{data:0})}}export{ke as component};
