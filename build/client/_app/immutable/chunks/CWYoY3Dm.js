import{S,i as N,s as j,n as C,d as h,b as v,c as _,v as f,e as d,f as y,x,h as g,j as m,k,Q as E,C as P,a as T,B as q,g as b,t as w}from"./DEZxJ6-q.js";import"./IHki7fMi.js";import"./CbqJmu3x.js";function z(c){let t,n="Login",l,a,i="Register";return{c(){t=m("a"),t.textContent=n,l=k(),a=m("a"),a.textContent=i,this.h()},l(e){t=d(e,"A",{href:!0,class:!0,"data-svelte-h":!0}),x(t)!=="svelte-1ikv9w7"&&(t.textContent=n),l=g(e),a=d(e,"A",{href:!0,class:!0,"data-svelte-h":!0}),x(a)!=="svelte-8w1kkx"&&(a.textContent=i),this.h()},h(){f(t,"href","/login"),f(t,"class","pill svelte-fet60v"),f(a,"href","/register"),f(a,"class","pill svelte-fet60v")},m(e,u){v(e,t,u),v(e,l,u),v(e,a,u)},p:C,d(e){e&&(h(t),h(l),h(a))}}}function B(c){let t,n,l=c[1].email+"",a,i,e,u="Logout",p,o;return{c(){t=m("span"),n=w("Hi, "),a=w(l),i=k(),e=m("button"),e.textContent=u,this.h()},l(s){t=d(s,"SPAN",{class:!0});var r=y(t);n=b(r,"Hi, "),a=b(r,l),r.forEach(h),i=g(s),e=d(s,"BUTTON",{class:!0,"data-svelte-h":!0}),x(e)!=="svelte-4qezu6"&&(e.textContent=u),this.h()},h(){f(t,"class","hello svelte-fet60v"),f(e,"class","pill svelte-fet60v")},m(s,r){v(s,t,r),_(t,n),_(t,a),v(s,i,r),v(s,e,r),p||(o=q(e,"click",c[2]),p=!0)},p(s,r){r&2&&l!==(l=s[1].email+"")&&T(a,l)},d(s){s&&(h(t),h(i),h(e)),p=!1,o()}}}function H(c){let t,n="â€¦";return{c(){t=m("span"),t.textContent=n,this.h()},l(l){t=d(l,"SPAN",{class:!0,"data-svelte-h":!0}),x(t)!=="svelte-9s1gh8"&&(t.textContent=n),this.h()},h(){f(t,"class","muted svelte-fet60v")},m(l,a){v(l,t,a)},p:C,d(l){l&&h(t)}}}function U(c){let t,n,l="Taleem.help",a,i,e;function u(s,r){return s[0]?H:s[1]?B:z}let p=u(c),o=p(c);return{c(){t=m("nav"),n=m("a"),n.textContent=l,a=k(),i=m("span"),e=k(),o.c(),this.h()},l(s){t=d(s,"NAV",{class:!0});var r=y(t);n=d(r,"A",{class:!0,href:!0,"data-svelte-h":!0}),x(n)!=="svelte-19kz9hq"&&(n.textContent=l),a=g(r),i=d(r,"SPAN",{class:!0}),y(i).forEach(h),e=g(r),o.l(r),r.forEach(h),this.h()},h(){f(n,"class","brand svelte-fet60v"),f(n,"href","/"),f(i,"class","spacer svelte-fet60v"),f(t,"class","nav svelte-fet60v")},m(s,r){v(s,t,r),_(t,n),_(t,a),_(t,i),_(t,e),o.m(t,null)},p(s,[r]){p===(p=u(s))&&o?o.p(s,r):(o.d(1),o=p(s),o&&(o.c(),o.m(t,null)))},i:C,o:C,d(s){s&&h(t),o.d()}}}function A(){let c=null;try{c=localStorage.getItem("token")}catch{}return c?{authorization:`Bearer ${c}`}:{}}async function I(){const c=await fetch("/api/auth/verify",{headers:{accept:"application/json",...A()}});if(!c.ok)return null;const t=await c.json().catch(()=>({}));return(t==null?void 0:t.user)??null}async function L(){const c=await fetch("/studio",{headers:{accept:"application/json",...A()}});if(!c.ok)return 0;const t=await c.json().catch(()=>({}));return Array.isArray(t==null?void 0:t.messages)?t.messages.length:0}function O(c,t,n){const l=E();let a=!0,i=null,e=0;async function u(){n(0,a=!0),n(1,i=await I()),e=i?await L():0,n(0,a=!1),l("authchange",{user:i,unread:e})}P(u);async function p(){try{await fetch("/api/auth/logout",{method:"POST"})}catch{}try{localStorage.removeItem("token")}catch{}n(1,i=null),e=0,l("authchange",{user:null,unread:0}),location.reload()}return[a,i,p]}class R extends S{constructor(t){super(),N(this,t,O,U,j,{})}}export{R as N};
