{"version":3,"file":"_page.svelte-D4yJsYdm.js","sources":["../../../.svelte-kit/adapter-node/entries/pages/admin/subscriptions/_page.svelte.js"],"sourcesContent":["import { c as create_ssr_component, d as add_attribute, f as each, e as escape, g as null_to_empty } from \"../../../../chunks/ssr.js\";\nimport \"@sveltejs/kit/internal\";\nimport \"../../../../chunks/exports.js\";\nimport \"../../../../chunks/utils.js\";\nimport \"../../../../chunks/state.svelte.js\";\nconst css = {\n  code: \".page.svelte-ug6hxk.svelte-ug6hxk{max-width:920px;margin:24px auto;padding:0 16px}h1.svelte-ug6hxk.svelte-ug6hxk{margin:0 0 16px 0;font-size:24px}.card.svelte-ug6hxk.svelte-ug6hxk{background:var(--panel-bg, #111);border:1px solid #2a2a2a;border-radius:12px;padding:16px;margin:12px 0;background-color:#190f0f;color:aliceblue}.row.svelte-ug6hxk.svelte-ug6hxk{display:grid;grid-template-columns:160px 1fr;gap:10px;align-items:center;margin:10px 0}label.svelte-ug6hxk.svelte-ug6hxk{font-weight:600;opacity:0.9;background-color:#333;color:aliceblue}input.svelte-ug6hxk.svelte-ug6hxk,select.svelte-ug6hxk.svelte-ug6hxk,button.svelte-ug6hxk.svelte-ug6hxk{padding:8px 10px;background-color:#333;color:aliceblue}button.svelte-ug6hxk.svelte-ug6hxk{border-radius:8px;border:1px solid #333;cursor:pointer}.hint.svelte-ug6hxk.svelte-ug6hxk{margin-top:8px;opacity:0.8}.muted.svelte-ug6hxk.svelte-ug6hxk{opacity:0.75}table.subs.svelte-ug6hxk.svelte-ug6hxk{width:100%;border-collapse:collapse}table.subs.svelte-ug6hxk th.svelte-ug6hxk,table.subs.svelte-ug6hxk td.svelte-ug6hxk{padding:8px 10px;border-top:1px solid #262626;text-align:left}tr.active.svelte-ug6hxk .status.svelte-ug6hxk{color:#66d9a8;font-weight:700}tr.expired.svelte-ug6hxk .status.svelte-ug6hxk{color:#ff6b6b;font-weight:700}tr.upcoming.svelte-ug6hxk .status.svelte-ug6hxk{color:#ffd166;font-weight:700}\",\n  map: `{\"version\":3,\"file\":\"+page.svelte\",\"sources\":[\"+page.svelte\"],\"sourcesContent\":[\"<script>\\\\n  // @ts-nocheck\\\\n  import { enhance } from '$app/forms';\\\\n  export let data;\\\\n\\\\n  console.log(\\\\\"data\\\\\",data);\\\\n  let email = data.selectedEmail ?? '';\\\\n  let tcode = '';\\\\n  let duration = 30;\\\\n  let startDate = '';\\\\n\\\\n  /** Keep the form prefilled when clicking \\\\\"Renew\\\\\" in the table */\\\\n  function prefillFromRow(row) {\\\\n    tcode = row.tcode;\\\\n    duration = 30;\\\\n    startDate = ''; // default to now; admin can choose\\\\n  }\\\\n\\\\n  // expose for noscript fallback too\\\\n  $: selectedUser = data.selectedUser;\\\\n  $: subscriptions = data.subscriptions ?? [];\\\\n<\\/script>\\\\n\\\\n<svelte:head>\\\\n  <title>Admin • Subscriptions</title>\\\\n</svelte:head>\\\\n\\\\n<div class=\\\\\"page\\\\\">\\\\n  <h1>Subscriptions (Admin)</h1>\\\\n\\\\n  <!-- 1) Find user by email (GET) -->\\\\n  <form class=\\\\\"card\\\\\" method=\\\\\"GET\\\\\">\\\\n    <h2>Find User</h2>\\\\n    <div class=\\\\\"row\\\\\">\\\\n      <label for=\\\\\"email\\\\\">Email</label>\\\\n      <input id=\\\\\"email\\\\\" name=\\\\\"email\\\\\" type=\\\\\"email\\\\\" bind:value={email} placeholder=\\\\\"user@example.com\\\\\" required />\\\\n    </div>\\\\n    <button type=\\\\\"submit\\\\\">Load</button>\\\\n  </form>\\\\n\\\\n  <!-- 2) Grant subscription (POST) -->\\\\n  <form class=\\\\\"card\\\\\" method=\\\\\"POST\\\\\" use:enhance>\\\\n    <h2>Grant Subscription</h2>\\\\n\\\\n    <div class=\\\\\"row\\\\\">\\\\n      <label for=\\\\\"grant-email\\\\\">Email</label>\\\\n      <input id=\\\\\"grant-email\\\\\" name=\\\\\"email\\\\\" type=\\\\\"email\\\\\" bind:value={email} placeholder=\\\\\"user@example.com\\\\\" required />\\\\n    </div>\\\\n\\\\n    <div class=\\\\\"row\\\\\">\\\\n      <label for=\\\\\"tcode\\\\\">Tcode</label>\\\\n      <select id=\\\\\"tcode\\\\\" name=\\\\\"tcode\\\\\" bind:value={tcode} required>\\\\n        <option value=\\\\\"\\\\\" disabled selected>Select tcode…</option>\\\\n        {#each data.tcodes as t}\\\\n          <option value={t.tcodeName}>{t.tcodeName} — {t.description}</option>\\\\n        {/each}\\\\n      </select>\\\\n    </div>\\\\n\\\\n    <div class=\\\\\"row\\\\\">\\\\n      <label for=\\\\\"duration\\\\\">Duration (days)</label>\\\\n      <input id=\\\\\"duration\\\\\" name=\\\\\"duration\\\\\" type=\\\\\"number\\\\\" min=\\\\\"1\\\\\" step=\\\\\"1\\\\\" bind:value={duration} required />\\\\n    </div>\\\\n\\\\n    <div class=\\\\\"row\\\\\">\\\\n      <label for=\\\\\"startDate\\\\\">Start Date (optional)</label>\\\\n      <input id=\\\\\"startDate\\\\\" name=\\\\\"startDate\\\\\" type=\\\\\"date\\\\\" bind:value={startDate} />\\\\n    </div>\\\\n\\\\n    <div class=\\\\\"row\\\\\">\\\\n      <button type=\\\\\"submit\\\\\" formaction=\\\\\"?/grant\\\\\">Grant</button>\\\\n    </div>\\\\n\\\\n    {#if selectedUser}\\\\n      <p class=\\\\\"hint\\\\\">Selected user: <strong>{selectedUser.email}</strong></p>\\\\n    {/if}\\\\n  </form>\\\\n\\\\n  <!-- 3) User subscriptions table -->\\\\n  <div class=\\\\\"card\\\\\">\\\\n    <h2>User Subscriptions</h2>\\\\n    {#if !selectedUser}\\\\n      <p class=\\\\\"muted\\\\\">Look up a user to view their subscriptions.</p>\\\\n    {:else if !subscriptions.length}\\\\n      <p class=\\\\\"muted\\\\\">No subscriptions yet for <strong>{selectedUser.email}</strong>.</p>\\\\n    {:else}\\\\n      <table class=\\\\\"subs\\\\\">\\\\n        <thead>\\\\n          <tr>\\\\n            <th>Tcode</th>\\\\n            <th>Start</th>\\\\n            <th>Duration</th>\\\\n            <th>Expires</th>\\\\n            <th>Status</th>\\\\n            <th>Remaining</th>\\\\n            <th>Quick</th>\\\\n          </tr>\\\\n        </thead>\\\\n        <tbody>\\\\n        {#each subscriptions as row}\\\\n          <tr class={row.status}>\\\\n            <td>{row.tcode}</td>\\\\n            <td>{row.start_date?.slice(0,10)}</td>\\\\n            <td>{row.duration}d</td>\\\\n            <td>{row.expiresAt?.slice(0,10)}</td>\\\\n            <td class=\\\\\"status\\\\\">{row.status}</td>\\\\n            <td>{row.status === 'active' ? \\`\\${row.remainingDays}d\\` : '-'}</td>\\\\n            <td>\\\\n              <button type=\\\\\"button\\\\\" on:click={() => prefillFromRow(row)}>Renew…</button>\\\\n            </td>\\\\n          </tr>\\\\n        {/each}\\\\n        </tbody>\\\\n      </table>\\\\n    {/if}\\\\n  </div>\\\\n</div>\\\\n\\\\n<style>\\\\n  .page { max-width: 920px; margin: 24px auto; padding: 0 16px; }\\\\n  h1 { margin: 0 0 16px 0; font-size: 24px; }\\\\n  .card { background: var(--panel-bg, #111); border: 1px solid #2a2a2a; border-radius: 12px; padding: 16px; margin: 12px 0;  background-color:  #190f0f;color:aliceblue;}\\\\n  .row { display: grid; grid-template-columns: 160px 1fr; gap: 10px; align-items: center; margin: 10px 0; }\\\\n  label { font-weight: 600; opacity: 0.9; background-color:  #333;color:aliceblue; }\\\\n  input, select, button { padding: 8px 10px;background-color:  #333;color:aliceblue; }\\\\n  button { border-radius: 8px; border: 1px solid #333; cursor: pointer; }\\\\n  .hint { margin-top: 8px; opacity: 0.8; }\\\\n  .muted { opacity: 0.75; }\\\\n  table.subs { width: 100%; border-collapse: collapse; }\\\\n  table.subs th, table.subs td { padding: 8px 10px; border-top: 1px solid #262626; text-align: left; }\\\\n  tr.active .status { color: #66d9a8; font-weight: 700; }\\\\n  tr.expired .status { color: #ff6b6b; font-weight: 700; }\\\\n  tr.upcoming .status { color: #ffd166; font-weight: 700; }\\\\n</style>\\\\n\"],\"names\":[],\"mappings\":\"AAuHE,iCAAM,CAAE,SAAS,CAAE,KAAK,CAAE,MAAM,CAAE,IAAI,CAAC,IAAI,CAAE,OAAO,CAAE,CAAC,CAAC,IAAM,CAC9D,8BAAG,CAAE,MAAM,CAAE,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAE,SAAS,CAAE,IAAM,CAC1C,iCAAM,CAAE,UAAU,CAAE,IAAI,UAAU,CAAC,KAAK,CAAC,CAAE,MAAM,CAAE,GAAG,CAAC,KAAK,CAAC,OAAO,CAAE,aAAa,CAAE,IAAI,CAAE,OAAO,CAAE,IAAI,CAAE,MAAM,CAAE,IAAI,CAAC,CAAC,CAAG,gBAAgB,CAAG,OAAO,CAAC,MAAM,SAAU,CACtK,gCAAK,CAAE,OAAO,CAAE,IAAI,CAAE,qBAAqB,CAAE,KAAK,CAAC,GAAG,CAAE,GAAG,CAAE,IAAI,CAAE,WAAW,CAAE,MAAM,CAAE,MAAM,CAAE,IAAI,CAAC,CAAG,CACxG,iCAAM,CAAE,WAAW,CAAE,GAAG,CAAE,OAAO,CAAE,GAAG,CAAE,gBAAgB,CAAG,IAAI,CAAC,MAAM,SAAW,CACjF,iCAAK,CAAE,kCAAM,CAAE,kCAAO,CAAE,OAAO,CAAE,GAAG,CAAC,IAAI,CAAC,gBAAgB,CAAG,IAAI,CAAC,MAAM,SAAW,CACnF,kCAAO,CAAE,aAAa,CAAE,GAAG,CAAE,MAAM,CAAE,GAAG,CAAC,KAAK,CAAC,IAAI,CAAE,MAAM,CAAE,OAAS,CACtE,iCAAM,CAAE,UAAU,CAAE,GAAG,CAAE,OAAO,CAAE,GAAK,CACvC,kCAAO,CAAE,OAAO,CAAE,IAAM,CACxB,KAAK,iCAAM,CAAE,KAAK,CAAE,IAAI,CAAE,eAAe,CAAE,QAAU,CACrD,KAAK,mBAAK,CAAC,gBAAE,CAAE,KAAK,mBAAK,CAAC,gBAAG,CAAE,OAAO,CAAE,GAAG,CAAC,IAAI,CAAE,UAAU,CAAE,GAAG,CAAC,KAAK,CAAC,OAAO,CAAE,UAAU,CAAE,IAAM,CACnG,EAAE,qBAAO,CAAC,qBAAQ,CAAE,KAAK,CAAE,OAAO,CAAE,WAAW,CAAE,GAAK,CACtD,EAAE,sBAAQ,CAAC,qBAAQ,CAAE,KAAK,CAAE,OAAO,CAAE,WAAW,CAAE,GAAK,CACvD,EAAE,uBAAS,CAAC,qBAAQ,CAAE,KAAK,CAAE,OAAO,CAAE,WAAW,CAAE,GAAK\"}`\n};\nconst Page = create_ssr_component(($$result, $$props, $$bindings, slots) => {\n  let selectedUser;\n  let subscriptions;\n  let { data } = $$props;\n  console.log(\"data\", data);\n  let email = data.selectedEmail ?? \"\";\n  let duration = 30;\n  let startDate = \"\";\n  if ($$props.data === void 0 && $$bindings.data && data !== void 0) $$bindings.data(data);\n  $$result.css.add(css);\n  selectedUser = data.selectedUser;\n  subscriptions = data.subscriptions ?? [];\n  return `${$$result.head += `<!-- HEAD_svelte-1o8ndr6_START -->${$$result.title = `<title>Admin • Subscriptions</title>`, \"\"}<!-- HEAD_svelte-1o8ndr6_END -->`, \"\"} <div class=\"page svelte-ug6hxk\"><h1 class=\"svelte-ug6hxk\" data-svelte-h=\"svelte-p1n89a\">Subscriptions (Admin)</h1>  <form class=\"card svelte-ug6hxk\" method=\"GET\"><h2 data-svelte-h=\"svelte-1jzegy0\">Find User</h2> <div class=\"row svelte-ug6hxk\"><label for=\"email\" class=\"svelte-ug6hxk\" data-svelte-h=\"svelte-1p9d3fm\">Email</label> <input id=\"email\" name=\"email\" type=\"email\" placeholder=\"user@example.com\" required class=\"svelte-ug6hxk\"${add_attribute(\"value\", email, 0)}></div> <button type=\"submit\" class=\"svelte-ug6hxk\" data-svelte-h=\"svelte-1o4yjun\">Load</button></form>  <form class=\"card svelte-ug6hxk\" method=\"POST\"><h2 data-svelte-h=\"svelte-fpr8r9\">Grant Subscription</h2> <div class=\"row svelte-ug6hxk\"><label for=\"grant-email\" class=\"svelte-ug6hxk\" data-svelte-h=\"svelte-fg5qb\">Email</label> <input id=\"grant-email\" name=\"email\" type=\"email\" placeholder=\"user@example.com\" required class=\"svelte-ug6hxk\"${add_attribute(\"value\", email, 0)}></div> <div class=\"row svelte-ug6hxk\"><label for=\"tcode\" class=\"svelte-ug6hxk\" data-svelte-h=\"svelte-6p13rk\">Tcode</label> <select id=\"tcode\" name=\"tcode\" required class=\"svelte-ug6hxk\"><option value=\"\" disabled selected data-svelte-h=\"svelte-11x0drw\">Select tcode…</option>${each(data.tcodes, (t) => {\n    return `<option${add_attribute(\"value\", t.tcodeName, 0)}>${escape(t.tcodeName)} — ${escape(t.description)}</option>`;\n  })}</select></div> <div class=\"row svelte-ug6hxk\"><label for=\"duration\" class=\"svelte-ug6hxk\" data-svelte-h=\"svelte-1e9580w\">Duration (days)</label> <input id=\"duration\" name=\"duration\" type=\"number\" min=\"1\" step=\"1\" required class=\"svelte-ug6hxk\"${add_attribute(\"value\", duration, 0)}></div> <div class=\"row svelte-ug6hxk\"><label for=\"startDate\" class=\"svelte-ug6hxk\" data-svelte-h=\"svelte-zj7jm1\">Start Date (optional)</label> <input id=\"startDate\" name=\"startDate\" type=\"date\" class=\"svelte-ug6hxk\"${add_attribute(\"value\", startDate, 0)}></div> <div class=\"row svelte-ug6hxk\" data-svelte-h=\"svelte-1df8u0c\"><button type=\"submit\" formaction=\"?/grant\" class=\"svelte-ug6hxk\">Grant</button></div> ${selectedUser ? `<p class=\"hint svelte-ug6hxk\">Selected user: <strong>${escape(selectedUser.email)}</strong></p>` : ``}</form>  <div class=\"card svelte-ug6hxk\"><h2 data-svelte-h=\"svelte-1mkkoa3\">User Subscriptions</h2> ${!selectedUser ? `<p class=\"muted svelte-ug6hxk\" data-svelte-h=\"svelte-k5u1c\">Look up a user to view their subscriptions.</p>` : `${!subscriptions.length ? `<p class=\"muted svelte-ug6hxk\">No subscriptions yet for <strong>${escape(selectedUser.email)}</strong>.</p>` : `<table class=\"subs svelte-ug6hxk\"><thead data-svelte-h=\"svelte-1xfvb8m\"><tr><th class=\"svelte-ug6hxk\">Tcode</th> <th class=\"svelte-ug6hxk\">Start</th> <th class=\"svelte-ug6hxk\">Duration</th> <th class=\"svelte-ug6hxk\">Expires</th> <th class=\"svelte-ug6hxk\">Status</th> <th class=\"svelte-ug6hxk\">Remaining</th> <th class=\"svelte-ug6hxk\">Quick</th></tr></thead> <tbody>${each(subscriptions, (row) => {\n    return `<tr class=\"${escape(null_to_empty(row.status), true) + \" svelte-ug6hxk\"}\"><td class=\"svelte-ug6hxk\">${escape(row.tcode)}</td> <td class=\"svelte-ug6hxk\">${escape(row.start_date?.slice(0, 10))}</td> <td class=\"svelte-ug6hxk\">${escape(row.duration)}d</td> <td class=\"svelte-ug6hxk\">${escape(row.expiresAt?.slice(0, 10))}</td> <td class=\"status svelte-ug6hxk\">${escape(row.status)}</td> <td class=\"svelte-ug6hxk\">${escape(row.status === \"active\" ? `${row.remainingDays}d` : \"-\")}</td> <td class=\"svelte-ug6hxk\"><button type=\"button\" class=\"svelte-ug6hxk\" data-svelte-h=\"svelte-pcbgtz\">Renew…</button></td> </tr>`;\n  })}</tbody></table>`}`}</div> </div>`;\n});\nexport {\n  Page as default\n};\n"],"names":[],"mappings":"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"}