{"version":3,"file":"_server-BVBFNbtq.js","sources":["../../../.svelte-kit/adapter-node/entries/endpoints/studio/_server.js"],"sourcesContent":["import { json } from \"@sveltejs/kit\";\nimport { p as prisma } from \"../../../chunks/prisma.js\";\nimport { v as verify } from \"../../../chunks/loginServices.js\";\nfunction getBearer(request, cookies, url) {\n  const h = request.headers.get(\"authorization\") || request.headers.get(\"Authorization\");\n  if (h?.startsWith(\"Bearer \")) return h.slice(7).trim();\n  return cookies.get(\"token\") || url.searchParams.get(\"token\") || null;\n}\nasync function GET({ request, cookies, url }) {\n  try {\n    const token = getBearer(request, cookies, url);\n    if (!token) return json({ ok: true, user: null, messages: [] });\n    const { user } = await verify(token);\n    if (!user) return json({ ok: true, user: null, messages: [] });\n    const messages = await prisma.studentMessage.findMany({\n      where: { user_id: user.id, read: false },\n      orderBy: { created_at: \"desc\" },\n      select: { id: true, category: true, message: true, created_at: true, read: true }\n    });\n    return json({ ok: true, user: { id: user.id, email: user.email }, messages });\n  } catch {\n    return json({ ok: true, user: null, messages: [] });\n  }\n}\nexport {\n  GET\n};\n"],"names":[],"mappings":";;;;;;;AAGA,SAAS,SAAS,CAAC,OAAO,EAAE,OAAO,EAAE,GAAG,EAAE;AAC1C,EAAE,MAAM,CAAC,GAAG,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,eAAe,CAAC,IAAI,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,eAAe,CAAC;AACxF,EAAE,IAAI,CAAC,EAAE,UAAU,CAAC,SAAS,CAAC,EAAE,OAAO,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE;AACxD,EAAE,OAAO,OAAO,CAAC,GAAG,CAAC,OAAO,CAAC,IAAI,GAAG,CAAC,YAAY,CAAC,GAAG,CAAC,OAAO,CAAC,IAAI,IAAI;AACtE;AACA,eAAe,GAAG,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,GAAG,EAAE,EAAE;AAC9C,EAAE,IAAI;AACN,IAAI,MAAM,KAAK,GAAG,SAAS,CAAC,OAAO,EAAE,OAAO,EAAE,GAAG,CAAC;AAClD,IAAI,IAAI,CAAC,KAAK,EAAE,OAAO,IAAI,CAAC,EAAE,EAAE,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,QAAQ,EAAE,EAAE,EAAE,CAAC;AACnE,IAAI,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,MAAM,CAAC,KAAK,CAAC;AACxC,IAAI,IAAI,CAAC,IAAI,EAAE,OAAO,IAAI,CAAC,EAAE,EAAE,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,QAAQ,EAAE,EAAE,EAAE,CAAC;AAClE,IAAI,MAAM,QAAQ,GAAG,MAAM,MAAM,CAAC,cAAc,CAAC,QAAQ,CAAC;AAC1D,MAAM,KAAK,EAAE,EAAE,OAAO,EAAE,IAAI,CAAC,EAAE,EAAE,IAAI,EAAE,KAAK,EAAE;AAC9C,MAAM,OAAO,EAAE,EAAE,UAAU,EAAE,MAAM,EAAE;AACrC,MAAM,MAAM,EAAE,EAAE,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,UAAU,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI;AACrF,KAAK,CAAC;AACN,IAAI,OAAO,IAAI,CAAC,EAAE,EAAE,EAAE,IAAI,EAAE,IAAI,EAAE,EAAE,EAAE,EAAE,IAAI,CAAC,EAAE,EAAE,KAAK,EAAE,IAAI,CAAC,KAAK,EAAE,EAAE,QAAQ,EAAE,CAAC;AACjF,EAAE,CAAC,CAAC,MAAM;AACV,IAAI,OAAO,IAAI,CAAC,EAAE,EAAE,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,QAAQ,EAAE,EAAE,EAAE,CAAC;AACvD,EAAE;AACF;;;;"}