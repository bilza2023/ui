import { c as create_ssr_component, f as add_attribute, d as each, e as escape, h as null_to_empty } from './ssr-CO7PFcwR.js';
import './ssr2-6RDSickK.js';
import './state.svelte-BCeRBbkS.js';

const css = {
  code: ".page.svelte-ug6hxk.svelte-ug6hxk{max-width:920px;margin:24px auto;padding:0 16px}h1.svelte-ug6hxk.svelte-ug6hxk{margin:0 0 16px 0;font-size:24px}.card.svelte-ug6hxk.svelte-ug6hxk{background:var(--panel-bg, #111);border:1px solid #2a2a2a;border-radius:12px;padding:16px;margin:12px 0;background-color:#190f0f;color:aliceblue}.row.svelte-ug6hxk.svelte-ug6hxk{display:grid;grid-template-columns:160px 1fr;gap:10px;align-items:center;margin:10px 0}label.svelte-ug6hxk.svelte-ug6hxk{font-weight:600;opacity:0.9;background-color:#333;color:aliceblue}input.svelte-ug6hxk.svelte-ug6hxk,select.svelte-ug6hxk.svelte-ug6hxk,button.svelte-ug6hxk.svelte-ug6hxk{padding:8px 10px;background-color:#333;color:aliceblue}button.svelte-ug6hxk.svelte-ug6hxk{border-radius:8px;border:1px solid #333;cursor:pointer}.hint.svelte-ug6hxk.svelte-ug6hxk{margin-top:8px;opacity:0.8}.muted.svelte-ug6hxk.svelte-ug6hxk{opacity:0.75}table.subs.svelte-ug6hxk.svelte-ug6hxk{width:100%;border-collapse:collapse}table.subs.svelte-ug6hxk th.svelte-ug6hxk,table.subs.svelte-ug6hxk td.svelte-ug6hxk{padding:8px 10px;border-top:1px solid #262626;text-align:left}tr.active.svelte-ug6hxk .status.svelte-ug6hxk{color:#66d9a8;font-weight:700}tr.expired.svelte-ug6hxk .status.svelte-ug6hxk{color:#ff6b6b;font-weight:700}tr.upcoming.svelte-ug6hxk .status.svelte-ug6hxk{color:#ffd166;font-weight:700}",
  map: `{"version":3,"file":"+page.svelte","sources":["+page.svelte"],"sourcesContent":["<script>\\n  // @ts-nocheck\\n  import { enhance } from '$app/forms';\\n  export let data;\\n\\n  console.log(\\"data\\",data);\\n  let email = data.selectedEmail ?? '';\\n  let tcode = '';\\n  let duration = 30;\\n  let startDate = '';\\n\\n  /** Keep the form prefilled when clicking \\"Renew\\" in the table */\\n  function prefillFromRow(row) {\\n    tcode = row.tcode;\\n    duration = 30;\\n    startDate = ''; // default to now; admin can choose\\n  }\\n\\n  // expose for noscript fallback too\\n  $: selectedUser = data.selectedUser;\\n  $: subscriptions = data.subscriptions ?? [];\\n<\/script>\\n\\n<svelte:head>\\n  <title>Admin • Subscriptions</title>\\n</svelte:head>\\n\\n<div class=\\"page\\">\\n  <h1>Subscriptions (Admin)</h1>\\n\\n  <!-- 1) Find user by email (GET) -->\\n  <form class=\\"card\\" method=\\"GET\\">\\n    <h2>Find User</h2>\\n    <div class=\\"row\\">\\n      <label for=\\"email\\">Email</label>\\n      <input id=\\"email\\" name=\\"email\\" type=\\"email\\" bind:value={email} placeholder=\\"user@example.com\\" required />\\n    </div>\\n    <button type=\\"submit\\">Load</button>\\n  </form>\\n\\n  <!-- 2) Grant subscription (POST) -->\\n  <form class=\\"card\\" method=\\"POST\\" use:enhance>\\n    <h2>Grant Subscription</h2>\\n\\n    <div class=\\"row\\">\\n      <label for=\\"grant-email\\">Email</label>\\n      <input id=\\"grant-email\\" name=\\"email\\" type=\\"email\\" bind:value={email} placeholder=\\"user@example.com\\" required />\\n    </div>\\n\\n    <div class=\\"row\\">\\n      <label for=\\"tcode\\">Tcode</label>\\n      <select id=\\"tcode\\" name=\\"tcode\\" bind:value={tcode} required>\\n        <option value=\\"\\" disabled selected>Select tcode…</option>\\n        {#each data.tcodes as t}\\n          <option value={t.tcodeName}>{t.tcodeName} — {t.description}</option>\\n        {/each}\\n      </select>\\n    </div>\\n\\n    <div class=\\"row\\">\\n      <label for=\\"duration\\">Duration (days)</label>\\n      <input id=\\"duration\\" name=\\"duration\\" type=\\"number\\" min=\\"1\\" step=\\"1\\" bind:value={duration} required />\\n    </div>\\n\\n    <div class=\\"row\\">\\n      <label for=\\"startDate\\">Start Date (optional)</label>\\n      <input id=\\"startDate\\" name=\\"startDate\\" type=\\"date\\" bind:value={startDate} />\\n    </div>\\n\\n    <div class=\\"row\\">\\n      <button type=\\"submit\\" formaction=\\"?/grant\\">Grant</button>\\n    </div>\\n\\n    {#if selectedUser}\\n      <p class=\\"hint\\">Selected user: <strong>{selectedUser.email}</strong></p>\\n    {/if}\\n  </form>\\n\\n  <!-- 3) User subscriptions table -->\\n  <div class=\\"card\\">\\n    <h2>User Subscriptions</h2>\\n    {#if !selectedUser}\\n      <p class=\\"muted\\">Look up a user to view their subscriptions.</p>\\n    {:else if !subscriptions.length}\\n      <p class=\\"muted\\">No subscriptions yet for <strong>{selectedUser.email}</strong>.</p>\\n    {:else}\\n      <table class=\\"subs\\">\\n        <thead>\\n          <tr>\\n            <th>Tcode</th>\\n            <th>Start</th>\\n            <th>Duration</th>\\n            <th>Expires</th>\\n            <th>Status</th>\\n            <th>Remaining</th>\\n            <th>Quick</th>\\n          </tr>\\n        </thead>\\n        <tbody>\\n        {#each subscriptions as row}\\n          <tr class={row.status}>\\n            <td>{row.tcode}</td>\\n            <td>{row.start_date?.slice(0,10)}</td>\\n            <td>{row.duration}d</td>\\n            <td>{row.expiresAt?.slice(0,10)}</td>\\n            <td class=\\"status\\">{row.status}</td>\\n            <td>{row.status === 'active' ? \`\${row.remainingDays}d\` : '-'}</td>\\n            <td>\\n              <button type=\\"button\\" on:click={() => prefillFromRow(row)}>Renew…</button>\\n            </td>\\n          </tr>\\n        {/each}\\n        </tbody>\\n      </table>\\n    {/if}\\n  </div>\\n</div>\\n\\n<style>\\n  .page { max-width: 920px; margin: 24px auto; padding: 0 16px; }\\n  h1 { margin: 0 0 16px 0; font-size: 24px; }\\n  .card { background: var(--panel-bg, #111); border: 1px solid #2a2a2a; border-radius: 12px; padding: 16px; margin: 12px 0;  background-color:  #190f0f;color:aliceblue;}\\n  .row { display: grid; grid-template-columns: 160px 1fr; gap: 10px; align-items: center; margin: 10px 0; }\\n  label { font-weight: 600; opacity: 0.9; background-color:  #333;color:aliceblue; }\\n  input, select, button { padding: 8px 10px;background-color:  #333;color:aliceblue; }\\n  button { border-radius: 8px; border: 1px solid #333; cursor: pointer; }\\n  .hint { margin-top: 8px; opacity: 0.8; }\\n  .muted { opacity: 0.75; }\\n  table.subs { width: 100%; border-collapse: collapse; }\\n  table.subs th, table.subs td { padding: 8px 10px; border-top: 1px solid #262626; text-align: left; }\\n  tr.active .status { color: #66d9a8; font-weight: 700; }\\n  tr.expired .status { color: #ff6b6b; font-weight: 700; }\\n  tr.upcoming .status { color: #ffd166; font-weight: 700; }\\n</style>\\n"],"names":[],"mappings":"AAuHE,iCAAM,CAAE,SAAS,CAAE,KAAK,CAAE,MAAM,CAAE,IAAI,CAAC,IAAI,CAAE,OAAO,CAAE,CAAC,CAAC,IAAM,CAC9D,8BAAG,CAAE,MAAM,CAAE,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAE,SAAS,CAAE,IAAM,CAC1C,iCAAM,CAAE,UAAU,CAAE,IAAI,UAAU,CAAC,KAAK,CAAC,CAAE,MAAM,CAAE,GAAG,CAAC,KAAK,CAAC,OAAO,CAAE,aAAa,CAAE,IAAI,CAAE,OAAO,CAAE,IAAI,CAAE,MAAM,CAAE,IAAI,CAAC,CAAC,CAAG,gBAAgB,CAAG,OAAO,CAAC,MAAM,SAAU,CACtK,gCAAK,CAAE,OAAO,CAAE,IAAI,CAAE,qBAAqB,CAAE,KAAK,CAAC,GAAG,CAAE,GAAG,CAAE,IAAI,CAAE,WAAW,CAAE,MAAM,CAAE,MAAM,CAAE,IAAI,CAAC,CAAG,CACxG,iCAAM,CAAE,WAAW,CAAE,GAAG,CAAE,OAAO,CAAE,GAAG,CAAE,gBAAgB,CAAG,IAAI,CAAC,MAAM,SAAW,CACjF,iCAAK,CAAE,kCAAM,CAAE,kCAAO,CAAE,OAAO,CAAE,GAAG,CAAC,IAAI,CAAC,gBAAgB,CAAG,IAAI,CAAC,MAAM,SAAW,CACnF,kCAAO,CAAE,aAAa,CAAE,GAAG,CAAE,MAAM,CAAE,GAAG,CAAC,KAAK,CAAC,IAAI,CAAE,MAAM,CAAE,OAAS,CACtE,iCAAM,CAAE,UAAU,CAAE,GAAG,CAAE,OAAO,CAAE,GAAK,CACvC,kCAAO,CAAE,OAAO,CAAE,IAAM,CACxB,KAAK,iCAAM,CAAE,KAAK,CAAE,IAAI,CAAE,eAAe,CAAE,QAAU,CACrD,KAAK,mBAAK,CAAC,gBAAE,CAAE,KAAK,mBAAK,CAAC,gBAAG,CAAE,OAAO,CAAE,GAAG,CAAC,IAAI,CAAE,UAAU,CAAE,GAAG,CAAC,KAAK,CAAC,OAAO,CAAE,UAAU,CAAE,IAAM,CACnG,EAAE,qBAAO,CAAC,qBAAQ,CAAE,KAAK,CAAE,OAAO,CAAE,WAAW,CAAE,GAAK,CACtD,EAAE,sBAAQ,CAAC,qBAAQ,CAAE,KAAK,CAAE,OAAO,CAAE,WAAW,CAAE,GAAK,CACvD,EAAE,uBAAS,CAAC,qBAAQ,CAAE,KAAK,CAAE,OAAO,CAAE,WAAW,CAAE,GAAK"}`
};
const Page = create_ssr_component(($$result, $$props, $$bindings, slots) => {
  let selectedUser;
  let subscriptions;
  let { data } = $$props;
  console.log("data", data);
  let email = data.selectedEmail ?? "";
  let duration = 30;
  let startDate = "";
  if ($$props.data === void 0 && $$bindings.data && data !== void 0) $$bindings.data(data);
  $$result.css.add(css);
  selectedUser = data.selectedUser;
  subscriptions = data.subscriptions ?? [];
  return `${$$result.head += `<!-- HEAD_svelte-1o8ndr6_START -->${$$result.title = `<title>Admin • Subscriptions</title>`, ""}<!-- HEAD_svelte-1o8ndr6_END -->`, ""} <div class="page svelte-ug6hxk"><h1 class="svelte-ug6hxk" data-svelte-h="svelte-p1n89a">Subscriptions (Admin)</h1>  <form class="card svelte-ug6hxk" method="GET"><h2 data-svelte-h="svelte-1jzegy0">Find User</h2> <div class="row svelte-ug6hxk"><label for="email" class="svelte-ug6hxk" data-svelte-h="svelte-1p9d3fm">Email</label> <input id="email" name="email" type="email" placeholder="user@example.com" required class="svelte-ug6hxk"${add_attribute("value", email, 0)}></div> <button type="submit" class="svelte-ug6hxk" data-svelte-h="svelte-1o4yjun">Load</button></form>  <form class="card svelte-ug6hxk" method="POST"><h2 data-svelte-h="svelte-fpr8r9">Grant Subscription</h2> <div class="row svelte-ug6hxk"><label for="grant-email" class="svelte-ug6hxk" data-svelte-h="svelte-fg5qb">Email</label> <input id="grant-email" name="email" type="email" placeholder="user@example.com" required class="svelte-ug6hxk"${add_attribute("value", email, 0)}></div> <div class="row svelte-ug6hxk"><label for="tcode" class="svelte-ug6hxk" data-svelte-h="svelte-6p13rk">Tcode</label> <select id="tcode" name="tcode" required class="svelte-ug6hxk"><option value="" disabled selected data-svelte-h="svelte-11x0drw">Select tcode…</option>${each(data.tcodes, (t) => {
    return `<option${add_attribute("value", t.tcodeName, 0)}>${escape(t.tcodeName)} — ${escape(t.description)}</option>`;
  })}</select></div> <div class="row svelte-ug6hxk"><label for="duration" class="svelte-ug6hxk" data-svelte-h="svelte-1e9580w">Duration (days)</label> <input id="duration" name="duration" type="number" min="1" step="1" required class="svelte-ug6hxk"${add_attribute("value", duration, 0)}></div> <div class="row svelte-ug6hxk"><label for="startDate" class="svelte-ug6hxk" data-svelte-h="svelte-zj7jm1">Start Date (optional)</label> <input id="startDate" name="startDate" type="date" class="svelte-ug6hxk"${add_attribute("value", startDate, 0)}></div> <div class="row svelte-ug6hxk" data-svelte-h="svelte-1df8u0c"><button type="submit" formaction="?/grant" class="svelte-ug6hxk">Grant</button></div> ${selectedUser ? `<p class="hint svelte-ug6hxk">Selected user: <strong>${escape(selectedUser.email)}</strong></p>` : ``}</form>  <div class="card svelte-ug6hxk"><h2 data-svelte-h="svelte-1mkkoa3">User Subscriptions</h2> ${!selectedUser ? `<p class="muted svelte-ug6hxk" data-svelte-h="svelte-k5u1c">Look up a user to view their subscriptions.</p>` : `${!subscriptions.length ? `<p class="muted svelte-ug6hxk">No subscriptions yet for <strong>${escape(selectedUser.email)}</strong>.</p>` : `<table class="subs svelte-ug6hxk"><thead data-svelte-h="svelte-1xfvb8m"><tr><th class="svelte-ug6hxk">Tcode</th> <th class="svelte-ug6hxk">Start</th> <th class="svelte-ug6hxk">Duration</th> <th class="svelte-ug6hxk">Expires</th> <th class="svelte-ug6hxk">Status</th> <th class="svelte-ug6hxk">Remaining</th> <th class="svelte-ug6hxk">Quick</th></tr></thead> <tbody>${each(subscriptions, (row) => {
    return `<tr class="${escape(null_to_empty(row.status), true) + " svelte-ug6hxk"}"><td class="svelte-ug6hxk">${escape(row.tcode)}</td> <td class="svelte-ug6hxk">${escape(row.start_date?.slice(0, 10))}</td> <td class="svelte-ug6hxk">${escape(row.duration)}d</td> <td class="svelte-ug6hxk">${escape(row.expiresAt?.slice(0, 10))}</td> <td class="status svelte-ug6hxk">${escape(row.status)}</td> <td class="svelte-ug6hxk">${escape(row.status === "active" ? `${row.remainingDays}d` : "-")}</td> <td class="svelte-ug6hxk"><button type="button" class="svelte-ug6hxk" data-svelte-h="svelte-pcbgtz">Renew…</button></td> </tr>`;
  })}</tbody></table>`}`}</div> </div>`;
});

export { Page as default };
//# sourceMappingURL=_page.svelte-D4yJsYdm.js.map
