import { c as create_ssr_component, v as validate_component, f as add_attribute, d as each, e as escape, h as null_to_empty } from './ssr-CO7PFcwR.js';
import './ssr2-6RDSickK.js';
import './state.svelte-BCeRBbkS.js';
import { N as Nav } from './Nav-CIe9NOWg.js';
import { A as AdminNav } from './AdminNav-DPQi_ewN.js';

const css = {
  code: ".page.svelte-12n6ptx.svelte-12n6ptx{max-width:920px;margin:24px auto;padding:0 16px;color:var(--primaryText)}h1.svelte-12n6ptx.svelte-12n6ptx{margin:0 0 16px 0;font-size:24px;color:var(--primaryText)}.form.svelte-12n6ptx .taleemTableWrap.svelte-12n6ptx{max-width:none;margin:0}tr.active.svelte-12n6ptx .status.svelte-12n6ptx{color:var(--secondaryColor);font-weight:700}tr.expired.svelte-12n6ptx .status.svelte-12n6ptx{color:color-mix(in oklab, var(--accentColor) 80%, var(--primaryText));font-weight:700}tr.upcoming.svelte-12n6ptx .status.svelte-12n6ptx{color:color-mix(in oklab, var(--primaryColor) 80%, var(--primaryText));font-weight:700}",
  map: `{"version":3,"file":"+page.svelte","sources":["+page.svelte"],"sourcesContent":["<script>\\n  // @ts-nocheck\\n  import { enhance } from '$app/forms';\\n  import '$lib/styles/forms.css';    // ✅ shared form styles\\n  import '$lib/styles/tables.css';   // ✅ shared table styles\\n  import Nav from \\"$lib/appComps/Nav.svelte\\";\\n  import AdminNav from \\"$lib/AdminNav.svelte\\";\\n\\n  export let data;\\n\\n  let email = data.selectedEmail ?? '';\\n  let tcode = '';\\n  let duration = 30;\\n  let startDate = '';\\n\\n  /** Keep the form prefilled when clicking \\"Renew\\" in the table */\\n  function prefillFromRow(row) {\\n    tcode = row.tcode;\\n    duration = 30;\\n    startDate = ''; // default to now; admin can choose\\n  }\\n\\n  // expose for noscript fallback too\\n  $: selectedUser = data.selectedUser;\\n  $: subscriptions = data.subscriptions ?? [];\\n<\/script>\\n\\n<Nav />\\n<AdminNav />\\n\\n<div class=\\"page\\">\\n  <h1>Subscriptions (Admin)</h1>\\n\\n  <!-- 1) Find user by email (GET) -->\\n  <form class=\\"form\\" method=\\"GET\\">\\n    <h2>Find User</h2>\\n    <div class=\\"row\\">\\n      <label for=\\"email\\">Email</label>\\n      <input id=\\"email\\" name=\\"email\\" type=\\"email\\" bind:value={email} placeholder=\\"user@example.com\\" required />\\n    </div>\\n    <div class=\\"actions\\">\\n      <button type=\\"submit\\" class=\\"primary\\">Load</button>\\n    </div>\\n  </form>\\n\\n  <!-- 2) Grant subscription (POST) -->\\n  <form class=\\"form\\" method=\\"POST\\" use:enhance>\\n    <h2>Grant Subscription</h2>\\n\\n    <div class=\\"row\\">\\n      <label for=\\"grant-email\\">Email</label>\\n      <input id=\\"grant-email\\" name=\\"email\\" type=\\"email\\" bind:value={email} placeholder=\\"user@example.com\\" required />\\n    </div>\\n\\n    <div class=\\"row\\">\\n      <label for=\\"tcode\\">Tcode</label>\\n      <select id=\\"tcode\\" name=\\"tcode\\" bind:value={tcode} required>\\n        <option value=\\"\\" disabled selected>Select tcode…</option>\\n        {#each data.tcodes as t}\\n          <option value={t.tcodeName}>{t.tcodeName} — {t.description}</option>\\n        {/each}\\n      </select>\\n    </div>\\n\\n    <div class=\\"row\\">\\n      <label for=\\"duration\\">Duration (days)</label>\\n      <input id=\\"duration\\" name=\\"duration\\" type=\\"number\\" min=\\"1\\" step=\\"1\\" bind:value={duration} required />\\n    </div>\\n\\n    <div class=\\"row\\">\\n      <label for=\\"startDate\\">Start Date (optional)</label>\\n      <input id=\\"startDate\\" name=\\"startDate\\" type=\\"date\\" bind:value={startDate} />\\n    </div>\\n\\n    <div class=\\"actions\\">\\n      <button type=\\"submit\\" class=\\"primary\\" formaction=\\"?/grant\\">Grant</button>\\n    </div>\\n\\n    {#if selectedUser}\\n      <p class=\\"hint\\">Selected user: <strong>{selectedUser.email}</strong></p>\\n    {/if}\\n  </form>\\n\\n  <!-- 3) User subscriptions table -->\\n  <div class=\\"form\\">\\n    <h2>User Subscriptions</h2>\\n    {#if !selectedUser}\\n      <p class=\\"muted\\">Look up a user to view their subscriptions.</p>\\n    {:else if !subscriptions.length}\\n      <p class=\\"muted\\">No subscriptions yet for <strong>{selectedUser.email}</strong>.</p>\\n    {:else}\\n      <div class=\\"taleemTableWrap\\">\\n        <table class=\\"taleemTable\\">\\n          <thead>\\n            <tr>\\n              <th>Tcode</th>\\n              <th>Start</th>\\n              <th>Duration</th>\\n              <th>Expires</th>\\n              <th>Status</th>\\n              <th>Remaining</th>\\n              <th>Quick</th>\\n            </tr>\\n          </thead>\\n          <tbody>\\n          {#each subscriptions as row}\\n            <tr class={row.status}>\\n              <td>{row.tcode}</td>\\n              <td>{row.start_date?.slice(0,10)}</td>\\n              <td>{row.duration}d</td>\\n              <td>{row.expiresAt?.slice(0,10)}</td>\\n              <td class=\\"status\\">{row.status}</td>\\n              <td>{row.status === 'active' ? \`\${row.remainingDays}d\` : '-'}</td>\\n              <td>\\n                <button type=\\"button\\" on:click={() => prefillFromRow(row)}>Renew…</button>\\n              </td>\\n            </tr>\\n          {/each}\\n          </tbody>\\n        </table>\\n      </div>\\n    {/if}\\n  </div>\\n</div>\\n\\n<style>\\n  .page {\\n    max-width: 920px;\\n    margin: 24px auto;\\n    padding: 0 16px;\\n    color: var(--primaryText);\\n  }\\n\\n  h1 { margin: 0 0 16px 0; font-size: 24px; color: var(--primaryText); }\\n\\n  /* Make the shared table fill the form panel */\\n  .form .taleemTableWrap {\\n    max-width: none;\\n    margin: 0;\\n  }\\n\\n  /* Status colors (tokens only) */\\n  tr.active   .status { color: var(--secondaryColor); font-weight: 700; }\\n  tr.expired  .status { color: color-mix(in oklab, var(--accentColor) 80%, var(--primaryText)); font-weight: 700; }\\n  tr.upcoming .status { color: color-mix(in oklab, var(--primaryColor) 80%, var(--primaryText)); font-weight: 700; }\\n</style>\\n"],"names":[],"mappings":"AA8HE,mCAAM,CACJ,SAAS,CAAE,KAAK,CAChB,MAAM,CAAE,IAAI,CAAC,IAAI,CACjB,OAAO,CAAE,CAAC,CAAC,IAAI,CACf,KAAK,CAAE,IAAI,aAAa,CAC1B,CAEA,gCAAG,CAAE,MAAM,CAAE,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAE,SAAS,CAAE,IAAI,CAAE,KAAK,CAAE,IAAI,aAAa,CAAG,CAGrE,oBAAK,CAAC,+BAAiB,CACrB,SAAS,CAAE,IAAI,CACf,MAAM,CAAE,CACV,CAGA,EAAE,sBAAO,CAAG,sBAAQ,CAAE,KAAK,CAAE,IAAI,gBAAgB,CAAC,CAAE,WAAW,CAAE,GAAK,CACtE,EAAE,uBAAQ,CAAE,sBAAQ,CAAE,KAAK,CAAE,UAAU,EAAE,CAAC,KAAK,CAAC,CAAC,IAAI,aAAa,CAAC,CAAC,GAAG,CAAC,CAAC,IAAI,aAAa,CAAC,CAAC,CAAE,WAAW,CAAE,GAAK,CAChH,EAAE,wBAAS,CAAC,sBAAQ,CAAE,KAAK,CAAE,UAAU,EAAE,CAAC,KAAK,CAAC,CAAC,IAAI,cAAc,CAAC,CAAC,GAAG,CAAC,CAAC,IAAI,aAAa,CAAC,CAAC,CAAE,WAAW,CAAE,GAAK"}`
};
const Page = create_ssr_component(($$result, $$props, $$bindings, slots) => {
  let selectedUser;
  let subscriptions;
  let { data } = $$props;
  let email = data.selectedEmail ?? "";
  let duration = 30;
  let startDate = "";
  if ($$props.data === void 0 && $$bindings.data && data !== void 0) $$bindings.data(data);
  $$result.css.add(css);
  selectedUser = data.selectedUser;
  subscriptions = data.subscriptions ?? [];
  return `${validate_component(Nav, "Nav").$$render($$result, {}, {}, {})} ${validate_component(AdminNav, "AdminNav").$$render($$result, {}, {}, {})} <div class="page svelte-12n6ptx"><h1 class="svelte-12n6ptx" data-svelte-h="svelte-p1n89a">Subscriptions (Admin)</h1>  <form class="form" method="GET"><h2 data-svelte-h="svelte-1jzegy0">Find User</h2> <div class="row"><label for="email" data-svelte-h="svelte-1p9d3fm">Email</label> <input id="email" name="email" type="email" placeholder="user@example.com" required${add_attribute("value", email, 0)}></div> <div class="actions" data-svelte-h="svelte-1upttmb"><button type="submit" class="primary">Load</button></div></form>  <form class="form" method="POST"><h2 data-svelte-h="svelte-fpr8r9">Grant Subscription</h2> <div class="row"><label for="grant-email" data-svelte-h="svelte-fg5qb">Email</label> <input id="grant-email" name="email" type="email" placeholder="user@example.com" required${add_attribute("value", email, 0)}></div> <div class="row"><label for="tcode" data-svelte-h="svelte-6p13rk">Tcode</label> <select id="tcode" name="tcode" required><option value="" disabled selected data-svelte-h="svelte-11x0drw">Select tcode…</option>${each(data.tcodes, (t) => {
    return `<option${add_attribute("value", t.tcodeName, 0)}>${escape(t.tcodeName)} — ${escape(t.description)}</option>`;
  })}</select></div> <div class="row"><label for="duration" data-svelte-h="svelte-1e9580w">Duration (days)</label> <input id="duration" name="duration" type="number" min="1" step="1" required${add_attribute("value", duration, 0)}></div> <div class="row"><label for="startDate" data-svelte-h="svelte-zj7jm1">Start Date (optional)</label> <input id="startDate" name="startDate" type="date"${add_attribute("value", startDate, 0)}></div> <div class="actions" data-svelte-h="svelte-ffhk7s"><button type="submit" class="primary" formaction="?/grant">Grant</button></div> ${selectedUser ? `<p class="hint">Selected user: <strong>${escape(selectedUser.email)}</strong></p>` : ``}</form>  <div class="form svelte-12n6ptx"><h2 data-svelte-h="svelte-1mkkoa3">User Subscriptions</h2> ${!selectedUser ? `<p class="muted" data-svelte-h="svelte-k5u1c">Look up a user to view their subscriptions.</p>` : `${!subscriptions.length ? `<p class="muted">No subscriptions yet for <strong>${escape(selectedUser.email)}</strong>.</p>` : `<div class="taleemTableWrap svelte-12n6ptx"><table class="taleemTable"><thead data-svelte-h="svelte-m4d6p2"><tr><th>Tcode</th> <th>Start</th> <th>Duration</th> <th>Expires</th> <th>Status</th> <th>Remaining</th> <th>Quick</th></tr></thead> <tbody>${each(subscriptions, (row) => {
    return `<tr class="${escape(null_to_empty(row.status), true) + " svelte-12n6ptx"}"><td>${escape(row.tcode)}</td> <td>${escape(row.start_date?.slice(0, 10))}</td> <td>${escape(row.duration)}d</td> <td>${escape(row.expiresAt?.slice(0, 10))}</td> <td class="status svelte-12n6ptx">${escape(row.status)}</td> <td>${escape(row.status === "active" ? `${row.remainingDays}d` : "-")}</td> <td><button type="button" data-svelte-h="svelte-pcbgtz">Renew…</button></td> </tr>`;
  })}</tbody></table></div>`}`}</div> </div>`;
});

export { Page as default };
//# sourceMappingURL=_page.svelte-CDx5qMqE.js.map
